<!DOCTYPE html>
<head>
<meta charset="utf-8" />
<meta name="keywords" content="BPM, business process management, workflow, processmaker, business, BPM Windows, BPM Linux, wiki, BPM documentation, BPM FAQ, task documentation, BPM PHP, BPM Open Source, BPM Variables, BPM Installation, BPM Programming, BPM Elements, BPM Concepts, BPM Frequently Asked Questions, BPM 3.0, BPM News, Release notes, DynaForms, BPM Community, BPM Enterprise, BPM Mobile, BPM Responsive Web Design, User Manual, BPM Resources" />
<link rel="alternate" hreflang="en" href="https://wiki.processmaker.com/index.html" />
<link rel="shortcut icon" href="https://wiki.processmaker.com/themes/thecompany_responsive_theme/favicon.ico" type="image/vnd.microsoft.icon" />
<meta name="description" content="ProcessMaker is commercial open source workflow and business process management software." />
<meta name="viewport" content="width=device-width" />
<meta name="Generator" content="Drupal 7 (http://drupal.org)" />
<link rel="canonical" href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html" />
<link rel="shortlink" href="https://wiki.processmaker.com/node/503.html" />
<title>3.0 - 3.8 - Calling REST Endpoints | Documentation@ProcessMaker</title>
<style type="text/css" media="all">
@import url("https://wiki.processmaker.com/modules/system/system.base.css?s743n7");
@import url("https://wiki.processmaker.com/modules/system/system.menus.css?s743n7");
@import url("https://wiki.processmaker.com/modules/system/system.messages.css?s743n7");
@import url("https://wiki.processmaker.com/modules/system/system.theme.css?s743n7");
</style>
<style type="text/css" media="all">
@import url("https://wiki.processmaker.com/modules/aggregator/aggregator.css?s743n7");
@import url("https://wiki.processmaker.com/modules/comment/comment.css?s743n7");
@import url("https://wiki.processmaker.com/modules/field/theme/field.css?s743n7");
@import url("https://wiki.processmaker.com/modules/node/node.css?s743n7");
@import url("https://wiki.processmaker.com/modules/search/search.css?s743n7");
@import url("https://wiki.processmaker.com/modules/toc_filter/toc_filter.css?s743n7");
@import url("https://wiki.processmaker.com/modules/user/user.css?s743n7");
@import url("https://wiki.processmaker.com/modules/views/css/views.css?s743n7");
</style>
<style type="text/css" media="all">
@import url("https://wiki.processmaker.com/sites/all/modules/colorbox/styles/default/colorbox_style.css?s743n7");
@import url("https://wiki.processmaker.com/modules/ctools/css/ctools.css?s743n7");
@import url("https://wiki.processmaker.com/sites/all/modules/geshifilter/geshifilter.css?s743n7");
@import url("https://wiki.processmaker.com/modules/panels/css/panels.css?s743n7");
@import url("https://wiki.processmaker.com/modules/nice_menus/css/nice_menus.css?s743n7");
@import url("https://wiki.processmaker.com/modules/nice_menus/css/nice_menus_default.css?s743n7");
@import url("https://wiki.processmaker.com/modules/fivestar/css/fivestar.css?s743n7");
</style>
<style type="text/css" media="all">
@import url("https://wiki.processmaker.com/themes/thecompany_responsive_theme/css/style.css?s743n7");
@import url("https://wiki.processmaker.com/themes/thecompany_responsive_theme/css/media.css?s743n7");
</style>
<script type="text/javascript" src="https://wiki.processmaker.com/modules/jquery_update/replace/jquery/1.9/jquery.min.js?v=1.9.1"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/misc/jquery.once.js?v=1.2"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/misc/drupal.js?s743n7"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/modules/nice_menus/js/jquery.bgiframe.js?v=2.1"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/modules/nice_menus/js/jquery.hoverIntent.js?v=0.5"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/modules/nice_menus/js/superfish.js?v=1.4.8"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/modules/nice_menus/js/nice_menus.js?v=1.0"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/modules/jquery_update/replace/ui/external/jquery.cookie.js?v=67fb34f6a866c40d0570"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/modules/jquery_update/replace/misc/jquery.form.min.js?v=2.69"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/misc/ajax.js?v=7.34"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/modules/jquery_update/js/jquery_update.js?v=0.0.1"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/modules/toc_filter/toc_filter.js?s743n7"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/sites/all/modules/colorbox/js/colorbox.js@s743n7"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/sites/all/modules/colorbox/styles/default/colorbox_style.js@s743n7"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/sites/all/modules/google_analytics/googleanalytics.js@s743n7"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
(function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga");ga("create", "UA-3380652-1", {"cookieDomain":"auto"});ga("set", "anonymizeIp", true);ga("send", "pageview");
//--><!]]>
</script>
<script type="text/javascript" src="https://wiki.processmaker.com/misc/progress.js?v=7.34"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/modules/fivestar/js/fivestar.ajax.js?s743n7"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/modules/fivestar/js/fivestar.js?s743n7"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/themes/thecompany_responsive_theme/js/jquery-1.10.2.min.js?s743n7"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/themes/thecompany_responsive_theme/js/jquery-ui.js?s743n7"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/themes/thecompany_responsive_theme/js/jquery-ui.min.js?s743n7"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/themes/thecompany_responsive_theme/js/custom.js?s743n7"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"thecompany_responsive_theme","theme_token":"OgU9XPzdpocMih7Ee8rSNzQP59ThIqKSn8a5fwazbOQ","jquery_version":"1.9","js":{"modules\/jquery_update\/replace\/jquery\/1.9\/jquery.min.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"modules\/nice_menus\/js\/jquery.bgiframe.js":1,"modules\/nice_menus\/js\/jquery.hoverIntent.js":1,"modules\/nice_menus\/js\/superfish.js":1,"modules\/nice_menus\/js\/nice_menus.js":1,"modules\/jquery_update\/replace\/ui\/external\/jquery.cookie.js":1,"modules\/jquery_update\/replace\/misc\/jquery.form.min.js":1,"misc\/ajax.js":1,"modules\/jquery_update\/js\/jquery_update.js":1,"modules\/toc_filter\/toc_filter.js":1,"sites\/all\/modules\/colorbox\/js\/colorbox.js":1,"sites\/all\/modules\/colorbox\/styles\/default\/colorbox_style.js":1,"sites\/all\/modules\/google_analytics\/googleanalytics.js":1,"0":1,"misc\/progress.js":1,"modules\/fivestar\/js\/fivestar.ajax.js":1,"modules\/fivestar\/js\/fivestar.js":1,"themes\/thecompany_responsive_theme\/js\/jquery-1.10.2.min.js":1,"themes\/thecompany_responsive_theme\/js\/jquery-ui.js":1,"themes\/thecompany_responsive_theme\/js\/jquery-ui.min.js":1,"themes\/thecompany_responsive_theme\/js\/custom.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"modules\/aggregator\/aggregator.css":1,"modules\/comment\/comment.css":1,"modules\/field\/theme\/field.css":1,"modules\/node\/node.css":1,"modules\/search\/search.css":1,"modules\/toc_filter\/toc_filter.css":1,"modules\/user\/user.css":1,"modules\/views\/css\/views.css":1,"sites\/all\/modules\/colorbox\/styles\/default\/colorbox_style.css":1,"modules\/ctools\/css\/ctools.css":1,"sites\/all\/modules\/geshifilter\/geshifilter.css":1,"modules\/panels\/css\/panels.css":1,"modules\/nice_menus\/css\/nice_menus.css":1,"modules\/nice_menus\/css\/nice_menus_default.css":1,"modules\/fivestar\/css\/fivestar.css":1,"themes\/thecompany_responsive_theme\/css\/style.css":1,"themes\/thecompany_responsive_theme\/css\/media.css":1}},"colorbox":{"opacity":"0.85","current":"{current} of {total}","previous":"\u00ab Prev","next":"Next \u00bb","close":"Close","maxWidth":"98%","maxHeight":"98%","fixed":true,"mobiledetect":true,"mobiledevicewidth":"480px","specificPagesDefaultValue":"admin*\nimagebrowser*\nimg_assist*\nimce*\nnode\/add\/*\nnode\/*\/edit\nprint\/*\nprintpdf\/*\nsystem\/ajax\nsystem\/ajax\/*"},"toc_filter_smooth_scroll_duration":"","googleanalytics":{"trackOutbound":1,"trackMailto":1,"trackDownload":1,"trackDownloadExtensions":"7z|aac|arc|arj|asf|asx|avi|bin|csv|doc(x|m)?|dot(x|m)?|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt(x|m)?|pot(x|m)?|pps(x|m)?|ppam|sld(x|m)?|thmx|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls(x|m|b)?|xlt(x|m)|xlam|xml|z|zip","trackColorbox":1},"nice_menus_options":{"delay":"800","speed":"slow"},"ajax":{"edit-vote--2":{"callback":"fivestar_ajax_submit","event":"change","url":"\/system\/ajax","submit":{"_triggering_element_name":"vote"}}}});
//--><!]]>
</script>
<!--[if lt IE 9]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','//connect.facebook.net/en_US/fbevents.js');
// Insert Your Facebook Pixel ID below.
fbq('init', '735235999992228');
fbq('track', 'PageView');
</script>
<!-- Insert Your Facebook Pixel ID below. -->
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=735235999992228&amp;ev=PageView&amp;noscript=1"
/></noscript>
<!-- End Facebook Pixel Code -->

</head>
<body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-503 node-type-processmakerbpm">
    
<div class="wrap">

<div id="header_wrapper">
  <div id="inner_header_wrapper">

    <header id="header" role="banner">
      
      <div class="header_inner_wrapper">
        <div class="header_left">
                      <div id="logo">
              <a href="https://wiki.processmaker.com/index.html" title="Home"><img src="../sites/default/files/full-logo.png"/></a>
            </div>
                    	  <div class="menu_wrapper">
            <nav id="main-menu"  role="navigation">
              <a class="nav-toggle" href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#">Navigation</a>
              <div class="menu-navigation-container">
                <ul class="menu"><li class="first leaf"><a href="https://wiki.processmaker.com/PM_Classic.html" title="Learn how to develop business solutions in ProcessMaker Platform while maintaining your existing ProcessMaker 3 solutions in PM Classic: the perfect bridge between your new and existing solutions with a state-of--the-art BPM platform.">PM Classic</a></li>
<li class="leaf"><a href="http://www.processmaker.com/tutorials" title="">Tutorials</a></li>
<li class="leaf"><a href="https://wiki.processmaker.com/3.1/user_guide.html">User Guide</a></li>
<li class="leaf"><a href="https://wiki.processmaker.com/3.1/developer_info.html">Developer Info</a></li>
<li class="leaf"><a href="https://wiki.processmaker.com/3.2/sys_administration.html">Sys Administration</a></li>
<li class="leaf"><a href="https://wiki.processmaker.com/3.1/resources.html">Helpful Resources</a></li>
<li class="leaf"><a href="https://wiki.processmaker.com/Sitemap.html">Sitemap</a></li>
<li class="last leaf"><a href="https://processmaker.gitbook.io/processmaker/" title="Read ProcessMaker Platform Spring 2023 documentation to learn more about the next generation of BPM.">ProcessMaker Platform</a></li>
</ul>              </div>
              <div class="clear"></div>
            </nav>
          </div>
                  <!--  <h1 id="site-title">
            <a href="/" title="Home">Documentation@ProcessMaker</a>
            <div id="site-description"></div>
          </h1> -->
            
        </div>
      </div>
      <div class="header_right">
          <div class="region region-search">
  <div id="block-search-form" class="block block-search">

        <h2 >_</h2>
    
  <div class="content">
    <form action="https://wiki.processmaker.com/3.0/Calling_REST_endpoints.html" method="post" id="search-block-form" accept-charset="UTF-8"><div><div class="container-inline">
    <div class="form-item form-type-textfield form-item-search-block-form">
  <label class="element-invisible" for="edit-search-block-form--2">Search </label>
 <input title="Enter the terms you wish to search for." placeholder="Search" type="text" id="edit-search-block-form--2" name="search_block_form" value="" size="15" maxlength="128" class="form-text" />
</div>
<div class="form-actions form-wrapper" id="edit-actions"><input type="submit" id="edit-submit" name="op" value="Search" class="form-submit" /></div><input type="hidden" name="form_build_id" value="form-NwgoKgrCFV9fp4YwXX8FwewQteCVsePQxOGfQdboRWo" />
<input type="hidden" name="form_id" value="search_block_form" />
</div>
</div></form>  </div>
  
</div> <!-- /.block -->
</div>
 <!-- /.region -->
                  <h1 class="page-title">3.0 - 3.8 - Calling REST Endpoints</h1>                <p class="page-title-suffix"></p>
                 <div style="margin-top: 5px;"></div>
      </div>
    </header>
    <div class="region-version">
      <span>Version: </span><ul><li><a  class="active-version">3.8</a></li><li><a  class="active-version">3.7</a></li><li><a  class="active-version">3.6</a></li><li><a  class="active-version">3.5</a></li><li><a  class="active-version">3.4</a></li><li><a  class="active-version">3.3</a></li><li><a  class="active-version">3.2</a></li><li><a  class="active-version">3.1</a></li><li><a  class="active-version">3.0</a></li><li><a href="https://wiki.processmaker.com/index.php/Calling_REST_Endpoints.html" class="">2.x</a></li></ul>    </div>
  </div>
</div>
<!-- <ul class="nice-menu nice-menu-down nice-menu-main-menu" id="nice-menu-0"><li class="menu-506 menu-path-node-1078 first odd "><a href="/PM_Classic" title="Learn how to develop business solutions in ProcessMaker Platform while maintaining your existing ProcessMaker 3 solutions in PM Classic: the perfect bridge between your new and existing solutions with a state-of--the-art BPM platform.">PM Classic</a></li>
<li class="menu-319 menu-path-processmakercom-tutorials  even "><a href="http://www.processmaker.com/tutorials" title="">Tutorials</a></li>
<li class="menu-320 menu-path-node-571  odd "><a href="/3.1/user_guide">User Guide</a></li>
<li class="menu-1138 menu-path-node-572  even "><a href="/3.1/developer_info">Developer Info</a></li>
<li class="menu-1197 menu-path-node-876  odd "><a href="/3.2/sys_administration">Sys Administration</a></li>
<li class="menu-1140 menu-path-node-236  even "><a href="/3.1/resources">Helpful Resources</a></li>
<li class="menu-1141 menu-path-node-554  odd "><a href="/Sitemap">Sitemap</a></li>
<li class="menu-1213 menu-path-sprocessmakergitbookio-processmaker-  even last"><a href="https://processmaker.gitbook.io/processmaker/" title="Read ProcessMaker Platform Spring 2023 documentation to learn more about the next generation of BPM.">ProcessMaker Platform</a></li>
</ul>
-->
  
  <div id="container">
    
    <div class="content-sidebar-wrap">

    <div id="content">

              <!-- <div id="breadcrumbs">
        <h2 class="element-invisible">You are here</h2><div class="breadcrumb"><a href="/">Home</a></div></div> -->
      
      <section id="post-content" role="main">
                                        <div class="region region-content">
  <div id="block-system-main" class="block block-system">

      
  <div class="content">
                          <span property="dc:title" content="3.0 - 3.8 - Calling REST Endpoints" class="rdf-meta element-hidden"></span>  
      
    
  <div class="content node-processmakerbpm">
    <div class="field field-name-field-how-useful-did-you-find-th field-type-fivestar field-label-above"><div class="field-label">Please rate how useful you found this document:&nbsp;</div><div class="field-items"><div class="field-item even"><form class="fivestar-widget" action="https://wiki.processmaker.com/3.0/Calling_REST_endpoints.html" method="post" id="fivestar-custom-widget" accept-charset="UTF-8"><div><div  class="clearfix fivestar-average-text fivestar-average-stars fivestar-form-item fivestar-default"><div class="form-item form-type-fivestar form-item-vote">
 <div class="form-item form-type-select form-item-vote">
 <select id="edit-vote--2" name="vote" class="form-select"><option value="-">Select rating</option><option value="20">Give 3.0 - 3.8 - Calling REST Endpoints 1/5</option><option value="40">Give 3.0 - 3.8 - Calling REST Endpoints 2/5</option><option value="60">Give 3.0 - 3.8 - Calling REST Endpoints 3/5</option><option value="80" selected="selected">Give 3.0 - 3.8 - Calling REST Endpoints 4/5</option><option value="100">Give 3.0 - 3.8 - Calling REST Endpoints 5/5</option></select>
<div class="description"><div class="fivestar-summary fivestar-summary-average-count"><span class="average-rating">Average: <span >3.2</span></span> <span class="total-votes">(<span >9</span> votes)</span></div></div>
</div>

</div>
</div><input class="fivestar-submit form-submit" type="submit" id="edit-fivestar-submit" name="op" value="Rate" /><input type="hidden" name="form_build_id" value="form-nKpN0oNxDrgC8HojiypUaQZ99sz6GilJ2H_hyxbI01Q" />
<input type="hidden" name="form_id" value="fivestar_custom_widget" />
</div></form></div></div></div><div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><div style="float: right; margin-left: 5px; background-color: #f9f9f9; border: 1px solid #aaaaaa; padding: 5px;"><center><strong>Contents:</strong> [<a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#" onclick="var el = document.getElementById('toc');
        var txt = ('innerText' in el)? 'innerText' : 'textContent';
        if (el.style.display=='none') { 
           el.style.display = '';
           document.getElementById('hideLabel')[txt] = 'hide';
        }
        else {
	        el.style.display = 'none';
           document.getElementById('hideLabel')[txt] = 'show';
        }"><span id="hideLabel">hide</span></a>]</b></center><div id="toc" ><ol class="toc">
<li class="toc"><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#Response_values" class="mw-headline">Response values</a></li>
<ol class="toc">
<li class="toc"><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#Errors" class="mw-headline">Errors</a></li>
<li class="toc"><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#Expired_Authorization" class="mw-headline">Expired Authorization</a></li>
</ol>
<li class="toc"><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#PHP" class="mw-headline">PHP</a></li>
<ol class="toc">
<li class="toc"><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#GET_requests" class="mw-headline">GET Requests</a></li>
<li class="toc"><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#POST_Requests" class="mw-headline">POST Requests</a></li>
<ol class="toc">
<li class="toc"><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#Converting_to_UTF-8" class="mw-headline">Converting to UTF-8</a></li>
</ol>
<li class="toc"><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#PUT_Requests" class="mw-headline">PUT Requests</a></li>
<li class="toc"><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#DELETE_requests" class="mw-headline">DELETE Requests</a></li>
<li class="toc"><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#PHP_pmRestRequest.28.29_function" class="mw-headline">PHP pmRestRequest() Function</a></li>
<li class="toc"><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#PHP_Calling_Rest_Endpoints_best_practices">PHP Calling REST Endpoints Best Practices </a></li>
<ol class="toc">
<li class="toc"><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#PHP_plugin">Using the plugin</a></li>
<li class="toc"><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#PHP_trigger">Using the trigger</a></li>
</ol>
</ol>
<li class="toc"><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#JavaScript" class="mw-headline">JavaScript</a></li>
<ol class="toc">
<li class="toc"><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#GET_requests_2" class="mw-headline">GET Requests</a></li>
<li class="toc"><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#PUT_requests_2" class="mw-headline">PUT Requests</a></li>
<li class="toc"><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#JavaScript_pmRestRequest.28.29_function" class="mw-headline">JavaScript <code>pmRestRequest()</code> Function</a></li>
<ol class="toc">
<li class="toc"><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#Executing_pmRestRequest.28.29_asynchronously" class="mw-headline">Executing <code>pmRestRequest()</code> Asynchronously</a></li>
<li class="toc"><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#Executing_pmRestRequest.28.29_synchronously" class="mw-headline">Executing <code>pmRestRequest()</code> Synchronously</a></li>
</ol>
<li class="toc"><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#Javascript_Calling_Rest_Endpoints_best_practices">Javascript Calling REST Endpoints Best Practices</a></li>
</ol>
<li class="toc"><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#Source_code_for_endpoints" class="mw-headline">Source Code for Endpoints</a></li>
<li class="toc"><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#Testing_Endpoints" class="mw-headline">Testing Endpoints</a></li>
<ol class="toc">
<li class="toc"><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#Using_Postman" class="mw-headline">Using Postman</a></li>
<li class="toc"><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#Using_HttpRequester" class="mw-headline">Using HttpRequester</a></li>
</ol>
</div></div>


<p>Once an access token is obtained from OAuth2.0, the ProcessMaker REST endpoints can be called using that access token. This page explains how to call REST endpoints using PHP, standard JavaScript and JQuery (which is a library of JavaScript).</p>

<p>Because there is a lot of code involved in sending out each HTTP request and processing the response, it is recommended to create a custom function named pmRestRequest() that will handle the REST requests. Using this function will simplify your code and help avoid duplication and errors.</p>

<h2><span id="Response_values" class="mw-headline">Response values</span></h2>

<p>When a REST request is successful, it will set the <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html" class="external text" rel="nofollow">HTTP status code</a> to <strong><code>200</code></strong> (OK) or <strong><code>201</code></strong> (Created). It is a good idea to always check whether a REST request was successful after executing it.</p>

<p>ProcessMaker REST endpoints have response values that will return <a href="http://json.org/" class="external text" rel="nofollow">JSON</a> (JavaScript Object Notation) strings, which need to be decoded. In PHP, the response value can be decoded using <a href="http://php.net/manual/en/function.json-decode.php" class="external text" rel="nofollow">json_decode()</a>.</p>

<p>In JavaScript, the <a href="http://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse" class="external text" rel="nofollow">JSON.parse()</a> function can be used to decode JSON strings if using a recent web browser that supports JSON (Internet Explorer 8+, Firefox 3.1+, Chrome 3+, Safari 4.0.3+ and Opera 10.5+). For older browsers, <a href="http://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval" class="external text" rel="nofollow">eval()</a> needs to be used, although it is not as safe. It is recommended to check whether the JSON object exists before calling the <code>JSON.parse()</code> method:</p>

<div class="geshifilter"><div class="javascript geshifilter-javascript" style="font-family:monospace;"><span style="color: #000066; font-weight: bold;">var</span> req <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">new</span> XMLHttpRequest<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
...<br />
<span style="color: #660066;">oRet</span> <span style="color: #339933;">=</span> <span style="color: #009900;">&#40;</span>JSON<span style="color: #009900;">&#41;</span> <span style="color: #339933;">?</span> JSON.<span style="color: #660066;">parse</span><span style="color: #009900;">&#40;</span>req.<span style="color: #660066;">responseText</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">:</span> eval<span style="color: #009900;">&#40;</span>req.<span style="color: #660066;">responseText</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<h3><span id="Errors" class="mw-headline">Errors</span></h3>

<p>If ProcessMaker detects an error in a REST request, the HTTP status code will be set to <strong><code>400</code></strong> (Bad Request) and the following error object will be returned:</p>

<div class="geshifilter"><div class="javascript geshifilter-javascript" style="font-family:monospace;"><span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;error<span style="color: #339933;">:</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; code<span style="color: #339933;">:</span> <span style="color: #CC0000;">400</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; message<span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;error-message&quot;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<p>If unable to handle the error, it is recommended to display the error to the user so someone can be contacted to fix the problem.</p>

<p>If an error occurs that isn't handled by ProcessMaker, then the HTTP status code will be set to another number and there will be no response value. For example, if the endpoint is misspelled or doesn't exist, the status code will be <strong><code>404</code></strong> (Not Found). If the workspace is misspelled or doesn't exist, the status code will be <strong><code>503</code></strong> (Service Unavailable). In these cases it is recommended to print the status code so the user can figure out what the problem is.</p>

<h3><span id="Expired_Authorization" class="mw-headline">Expired Authorization</span></h3>

<p>If the access token has expired or is invalid, the HTTP status code will be set to <strong><code>401</code></strong> (Unauthorized) and the following error object will be returned:</p>

<div class="geshifilter"><div class="javascript geshifilter-javascript" style="font-family:monospace;"><span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;error<span style="color: #339933;">:</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; code<span style="color: #339933;">:</span> &nbsp; &nbsp;<span style="color: #CC0000;">401</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; message<span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;Unauthorized&quot;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<h2><span id="PHP" class="mw-headline">PHP</span></h2>

<p>The <a href="http://php.net/manual/en/book.curl.php" class="external text" rel="nofollow">cURL</a> library in PHP can be used to call ProcessMaker REST endpoints. For each REST request, the configuration of the HTTP header is different, depending on whether the method is GET, POST, PUT or DELETE.</p>

<p>All requests of a ProcessMaker REST endpoint need to include the access token in the HTTP header. For example, if the access token is "38d25eab20873124becc8948df03e14519f93695", then it is included in the header in this manner:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$ch</span> <span style="color: #339933;">=</span> <a href="http://php.net/curl_init"><span style="color: #990000;">curl_init</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;https://example.com/api/1.0/workflow/users&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_HTTPHEADER<span style="color: #339933;">,</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Authorization: Bearer 38d25eab20873124becc8948df03e14519f93695&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<h3><span id="GET_requests" class="mw-headline">GET Requests</span></h3>

<p>To call a GET endpoint using cURL and get the response object and HTTP status code:</p>

<codeblock>$ch = curl_init("<em><font color=blue>url</font></em>");
curl_setopt($ch, CURLOPT_HTTPHEADER, array("Authorization: Bearer <em><font color=blue>access-token</font></em>"));
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$oRet = json_decode(curl_exec($ch));
$status = curl_getinfo($ch, CURLINFO_HTTP_CODE);
</codeblock>

<p>For example, to get print a list of all the active ProcessMaker users:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$pmServer</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;https://example.com&quot;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set to your ProcessMaker address</span><br />
<br />
<span style="color: #000088;">$accessToken</span> <span style="color: #339933;">=</span> <a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$_COOKIE</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'access_token'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span> ? <span style="color: #000088;">$_COOKIE</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'access_token'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">:</span> getAccessToken<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000088;">$ch</span> <span style="color: #339933;">=</span> <a href="http://php.net/curl_init"><span style="color: #990000;">curl_init</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$pmServer</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;/api/1.0/workflow/users&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_HTTPHEADER<span style="color: #339933;">,</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Authorization: Bearer &quot;</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$accessToken</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_RETURNTRANSFER<span style="color: #339933;">,</span> <span style="color: #009900; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$aUsers</span> <span style="color: #339933;">=</span> <a href="http://php.net/json_decode"><span style="color: #990000;">json_decode</span></a><span style="color: #009900;">&#40;</span><a href="http://php.net/curl_exec"><span style="color: #990000;">curl_exec</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$statusCode</span> <span style="color: #339933;">=</span> <a href="http://php.net/curl_getinfo"><span style="color: #990000;">curl_getinfo</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLINFO_HTTP_CODE<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<a href="http://php.net/curl_close"><span style="color: #990000;">curl_close</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$statusCode</span> <span style="color: #339933;">!=</span> <span style="color: #cc66cc;">200</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/isset"><span style="color: #990000;">isset</span></a> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUsers</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUsers</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">error</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">print</span> <span style="color: #0000ff;">&quot;Error code: <span style="color: #006699; font-weight: bold;">{$aUsers-&gt;error-&gt;code}</span><span style="color: #000099; font-weight: bold;">\n</span>Message: <span style="color: #006699; font-weight: bold;">{$aUsers-&gt;error-&gt;message}</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">else</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">print</span> <span style="color: #0000ff;">&quot;Error: HTTP status code: <span style="color: #006699; font-weight: bold;">$statusCode</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUsers</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$oUser</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$oUser</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">usr_status</span> <span style="color: #339933;">==</span> <span style="color: #0000ff;">&quot;ACTIVE&quot;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #b1b100;">print</span> <span style="color: #0000ff;">&quot;<span style="color: #006699; font-weight: bold;">{$oUser-&gt;usr_firstname}</span> <span style="color: #006699; font-weight: bold;">{$oUser-&gt;usr_lastname}</span> (<span style="color: #006699; font-weight: bold;">{$oUser-&gt;usr_username}</span>)<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<h3><span id="POST_Requests" class="mw-headline">POST Requests</span></h3>

<p>POST variables can either be sent as a string in <a href="https://en.wikipedia.org/wiki/Percent-encoding#The_application.2Fx-www-form-urlencoded_type">application/x-www-form-urlencoded</a> format (which is the default standard for form data) or as a <a href="https://en.wikipedia.org/wiki/JSON">JavaScript Object Notation (JSON)</a> string, which is more precise and recommended.
 
<p>To send a POST request in application/x-www-form-urlencoded format, create an associative array where each key is the name of a POST variable. This associative array is included with the request by using the <code>CURLOPT_POSTFIELDS option</code> in the <a href="http://php.net/manual/en/function.curl-setopt.php">curl_setopt()</a> function. If it is an array or object, <code>curl_setopt()</code> will automatically convert it into a string.</p>  

<p>If the POST variables contain an array within an array (which may happen with a few endpoints such as <a href="https://wiki.processmaker.com/REST_API_Cases.html#New_Case:_POST_.2Fcases">/cases/</a> and <a href="https://wiki.processmaker.com/REST_API_Cases.html#Case_Variables">/cases/{app_uid}/variables</a>), then the <a href="http://php.net/manual/en/function.http-build-query.php">http_build_query()</a> function needs to be used to convert the array into a string and <a href="http://www.w3schools.com/tags/ref_urlencode.asp">URL-encode</a> it. 

<codeblock>$aVars = array(
   "<em><font color=blue>variable1</font></em>" => "<em><font color=blue>value1</font></em>",
   "<em><font color=blue>variable2</font></em>" => "<em><font color=blue>value2</font></em>"
);
$ch = curl_init("<em><font color=blue>url</font></em>");
curl_setopt($ch, CURLOPT_HTTPHEADER, array("Authorization: Bearer <em><font color=blue>access-token</font></em>"));
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($aVars));
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$oRet = json_decode(curl_exec($ch));
$status = curl_getinfo($ch, CURLINFO_HTTP_CODE);
</codeblock>

<p><font color=green><b>Note:</b></font> <font color=dimgrey>One of the problems with using <code>http_build_query()</code> is that ProcessMaker REST endpoints often interpret numbers as strings, which can cause problems when REST endpoints do error checking. If a REST endpoint complains about a variable which requires an integer, then it is recommended to pass the POST variables as a JSON string. The other problem is when sending a file in one of the POST variables. If sending a file, it is recommended to NOT pass the POST variables through <code>http_build_query()</code>.</font>   

<p>To send the POST variables as a JSON string, create an associative array where each key is the name of a POST variable. Then, use PHP's <a href="http://php.net/manual/en/function.json-encode.php">json_encode()</a> function to convert it into a JSON string. 

<codeblock>$aVars = array(
   "<em><font color=blue>variable1</font></em>" => "<em><font color=blue>value1</font></em>",
   "<em><font color=blue>variable2</font></em>" => "<em><font color=blue>value2</font></em>"
);
$json = json_encode($aVars);
$ch = curl_init("<em><font color=blue>url</font></em>");
curl_setopt($ch, CURLOPT_HTTPHEADER, array(
   "Authorization: Bearer <em><font color=blue>access-token</font></em>",
   'Content-Type: application/json',                                                                                
   'Content-Length: ' . strlen($json)
));
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $json);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$oRet = json_decode(curl_exec($ch));
$status = curl_getinfo($ch, CURLINFO_HTTP_CODE);
</codeblock>


<h4><span id="Converting_to_UTF-8" class="mw-headline">Converting to UTF-8</span></h4>
If the values of the POST or PUT variables do not use the UTF-8 character set, then they first need to be converted to UTF-8 using the <a href="http://php.net/manual/en/function.mb-convert-encoding.php">mb_convert_encoding()</a> function. For example, if converting from ISO-8859-15 to UTF-8:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$aVars</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">&quot;position&quot;</span> &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;Lingüista español&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">&quot;associate&quot;</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;José Ibáñez&quot;</span><br />
<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">foreach</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aVars</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$key</span> <span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$value</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aVars</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$key</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> <a href="http://php.net/mb_convert_encoding"><span style="color: #990000;">mb_convert_encoding</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$value</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'UTF-8'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'ISO-8859-15'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<h3><span id="PUT_Requests" class="mw-headline">PUT Requests</span></h3>

<p>PUT requests are similar to POST requests. The command <code>curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "PUT")</code> is used to change the request from POST to PUT. Like POST requests, it is recommended to use the <a href="http://php.net/manual/en/function.http-build-query.php">http_build_query()</a> function to convert the array of PUT variables into a string and URL-encode it:</p>

<codeblock>$aVars = array(
   "variable1" => "value1",
   "variable2" => "value2",
   ...
);
$ch = curl_init("<em><font color=blue>url</font></em>");
curl_setopt($ch, CURLOPT_HTTPHEADER, array("Authorization: Bearer <em><font color=blue>access-token</font></em>"));
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "PUT");
curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($aVars));
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$oRet = json_decode(curl_exec($ch));
$status = curl_getinfo($ch, CURLINFO_HTTP_CODE);
</codeblock>

<p><strong>Example:</strong></p>

<p>The following example changes the status of a user to "VACATION" and sets the replacement user:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$apiServer</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;https://example.com&quot;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//set to your ProcessMaker address</span><br />
<span style="color: #000088;">$userId</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;75740355754dd28ba73d7d6082172937&quot;</span><span style="color: #339933;">;</span> &nbsp;<span style="color: #666666; font-style: italic;">//set to the unique ID of a user</span><br />
<br />
<span style="color: #000088;">$accessToken</span> <span style="color: #339933;">=</span> <a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$_COOKIE</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'access_token'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span> ? <span style="color: #000088;">$_COOKIE</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'access_token'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">:</span> getAccessToken<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000088;">$postParams</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><br />
&nbsp; <span style="color: #0000ff;">'usr_status'</span> &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;VACATION&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; <span style="color: #0000ff;">'usr_replaced_by'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;14680180454ca4477335a27034362107&quot;</span><br />
<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000088;">$ch</span> <span style="color: #339933;">=</span> <a href="http://php.net/curl_init"><span style="color: #990000;">curl_init</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$apiServer</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;/api/1.0/workflow/user/&quot;</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$userId</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_HTTPHEADER<span style="color: #339933;">,</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Authorization: Bearer <span style="color: #006699; font-weight: bold;">$accessToken</span>&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_RETURNTRANSFER<span style="color: #339933;">,</span> <span style="color: #009900; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_CUSTOMREQUEST<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;PUT&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_POSTFIELDS<span style="color: #339933;">,</span> <a href="http://php.net/http_build_query"><span style="color: #990000;">http_build_query</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$postParams</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$oResult</span> <span style="color: #339933;">=</span> <a href="http://php.net/json_decode"><span style="color: #990000;">json_decode</span></a><span style="color: #009900;">&#40;</span><a href="http://php.net/curl_exec"><span style="color: #990000;">curl_exec</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$statusCode</span> <span style="color: #339933;">=</span> <a href="http://php.net/curl_getinfo"><span style="color: #990000;">curl_getinfo</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLINFO_HTTP_CODE<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$oResult</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$oResult</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">error</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">print</span> <span style="color: #0000ff;">&quot;Error in <span style="color: #006699; font-weight: bold;">$apiServer</span>: <span style="color: #000099; font-weight: bold;">\n</span>Code: <span style="color: #006699; font-weight: bold;">{$oResult-&gt;error-&gt;code}</span><span style="color: #000099; font-weight: bold;">\n</span>Message: <span style="color: #006699; font-weight: bold;">{$oResult-&gt;error-&gt;message}</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #b1b100;">elseif</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$oResult</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$oResult</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">usr_uid</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">print</span> <span style="color: #0000ff;">&quot;User '<span style="color: #006699; font-weight: bold;">{$oResult-&gt;usr_uid}</span>' updated:<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<a href="http://php.net/print_r"><span style="color: #990000;">print_r</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$oResult</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">print</span> <span style="color: #0000ff;">&quot;Error updating user: HTTP status code: <span style="color: #006699; font-weight: bold;">$statusCode</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<a href="http://php.net/curl_close"><span style="color: #990000;">curl_close</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<h3><span id="DELETE_requests" class="mw-headline">DELETE Requests</span></h3>

<p>To send a DELETE request:</p>

<codeblock>$ch = curl_init("<em><font color=blue>url</font></em>");
curl_setopt($ch, CURLOPT_HTTPHEADER, array("Authorization: Bearer <em><font color=blue>access-token</font></em>"));
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "DELETE")
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$oRet = json_decode(curl_exec($ch));
$status = curl_getinfo($ch, CURLINFO_HTTP_CODE);
</codeblock>

<p>Most DELETE requests don't have a response value, so make sure to check whether the HTTP status code is 200 to determine whether the request was successful.</p>

<p><strong>Example:</strong><br> This example deletes a user:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$apiServer</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;https://example.com&quot;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set to your ProcessMaker address</span><br />
<span style="color: #000088;">$userId</span> &nbsp; &nbsp;<span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;75740355754dd28ba73d7d6082172937&quot;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set to a user's ID</span><br />
<span style="color: #000088;">$accessToken</span> <span style="color: #339933;">=</span> <a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$_COOKIE</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'access_token'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span> ? <span style="color: #000088;">$_COOKIE</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'access_token'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">:</span> getAccessToken<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000088;">$ch</span> <span style="color: #339933;">=</span> <a href="http://php.net/curl_init"><span style="color: #990000;">curl_init</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$apiServer</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;/api/1.0/workflow/user/<span style="color: #006699; font-weight: bold;">$userId</span>&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_HTTPHEADER<span style="color: #339933;">,</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Authorization: Bearer <span style="color: #006699; font-weight: bold;">$accessToken</span>&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_TIMEOUT<span style="color: #339933;">,</span> <span style="color: #cc66cc;">30</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_RETURNTRANSFER<span style="color: #339933;">,</span> <span style="color: #009900; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_CUSTOMREQUEST<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;DELETE&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$oResult</span> <span style="color: #339933;">=</span> <a href="http://php.net/json_decode"><span style="color: #990000;">json_decode</span></a><span style="color: #009900;">&#40;</span><a href="http://php.net/curl_exec"><span style="color: #990000;">curl_exec</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$statusCode</span> <span style="color: #339933;">=</span> <a href="http://php.net/curl_getinfo"><span style="color: #990000;">curl_getinfo</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLINFO_HTTP_CODE<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$statusCode</span> <span style="color: #339933;">!=</span> <span style="color: #cc66cc;">200</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$oResult</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$oResult</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">error</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">print</span> <span style="color: #0000ff;">&quot;Error in <span style="color: #006699; font-weight: bold;">$apiServer</span>: <span style="color: #000099; font-weight: bold;">\n</span>Code: <span style="color: #006699; font-weight: bold;">{$oResult-&gt;error-&gt;code}</span><span style="color: #000099; font-weight: bold;">\n</span>Message: <span style="color: #006699; font-weight: bold;">{$oResult-&gt;error-&gt;message}</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">print</span> <span style="color: #0000ff;">&quot;Error: HTTP status code: <span style="color: #006699; font-weight: bold;">$statusCode</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span><br />
<a href="http://php.net/curl_close"><span style="color: #990000;">curl_close</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<h3><span id="PHP_pmRestRequest.28.29_function" class="mw-headline">PHP pmRestRequest() Function</span></h3>

<p>The best way to avoid code duplication is to create a generic function that can handle ProcessMaker REST requests. This function will set the headers depending on the HTTP method and execute the request using cURL. If an error occurs, it will print the error. Then, it returns an object containing the HTTP status code and the response object.</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$pmServer</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;https://example.com&quot;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set to address of the ProcessMaker server</span><br />
<br />
<span style="color: #666666; font-style: italic;">/*Function to call a ProcessMaker REST endpoint and return the HTTP status code and<br />
response if any.<br />
Parameters:<br />
&nbsp;$method: &nbsp; &nbsp; &nbsp;HTTP method: &quot;GET&quot;, &quot;POST&quot;, &quot;PUT&quot; or &quot;DELETE&quot;<br />
&nbsp;$endpoint: &nbsp; &nbsp;The PM endpoint, not including the server's address and port number.<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Ex: &quot;/api/1.0/workflow/cases&quot;<br />
&nbsp;$aVars: &nbsp; &nbsp; &nbsp; Optional. Associative array containing the variables to use in the request<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if &quot;POST&quot; or &quot;PUT&quot; method.<br />
&nbsp;$accessToken: Optional. The access token, which comes from oauth2/token. If not defined<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;then uses the access token in $_COOKIE['access_token']<br />
Return Value:<br />
&nbsp;object {<br />
&nbsp; &nbsp; response: Response from REST endpoint, decoded with json_decode().<br />
&nbsp; &nbsp; status: &nbsp; HTTP status code: 200 (OK), 201 (Created), 400 (Bad Request), 404 (Not found), etc.<br />
&nbsp;} &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/</span><br />
<span style="color: #000000; font-weight: bold;">function</span> pmRestRequest<span style="color: #009900;">&#40;</span><span style="color: #000088;">$method</span><span style="color: #339933;">,</span> <span style="color: #000088;">$endpoint</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aVars</span> <span style="color: #339933;">=</span> <span style="color: #009900; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #000088;">$accessToken</span> <span style="color: #339933;">=</span> <span style="color: #009900; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000000; font-weight: bold;">global</span> <span style="color: #000088;">$pmServer</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp;<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$accessToken</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$_COOKIE</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'access_token'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$accessToken</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$_COOKIE</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'access_token'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp;<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$accessToken</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #666666; font-style: italic;">//if the access token has expired</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//To check if the PM login session has expired: !isset($_COOKIE['PHPSESSID'])</span><br />
&nbsp; &nbsp; &nbsp; <a href="http://php.net/header"><span style="color: #990000;">header</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Location: loginForm.php&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//change to match your login method</span><br />
&nbsp; &nbsp; &nbsp; <a href="http://php.net/die"><span style="color: #990000;">die</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<br />
&nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//add beginning / to endpoint if it doesn't exist:</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$endpoint</span><span style="color: #009900;">&#41;</span> and <span style="color: #000088;">$endpoint</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">!=</span> <span style="color: #0000ff;">&quot;/&quot;</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$endpoint</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;/&quot;</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$endpoint</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp;<span style="color: #000088;">$ch</span> <span style="color: #339933;">=</span> <a href="http://php.net/curl_init"><span style="color: #990000;">curl_init</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$pmServer</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$endpoint</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_HTTPHEADER<span style="color: #339933;">,</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Authorization: Bearer &quot;</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$accessToken</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_TIMEOUT<span style="color: #339933;">,</span> <span style="color: #cc66cc;">30</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_RETURNTRANSFER<span style="color: #339933;">,</span> <span style="color: #009900; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$method</span> <span style="color: #339933;">=</span> <a href="http://php.net/strtoupper"><span style="color: #990000;">strtoupper</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$method</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp;<span style="color: #b1b100;">switch</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$method</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">&quot;GET&quot;</span><span style="color: #339933;">:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #b1b100;">break</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">&quot;DELETE&quot;</span><span style="color: #339933;">:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_CUSTOMREQUEST<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;DELETE&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #b1b100;">break</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">&quot;PUT&quot;</span><span style="color: #339933;">:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_CUSTOMREQUEST<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;PUT&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">&quot;POST&quot;</span><span style="color: #339933;">:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_POST<span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_POSTFIELDS<span style="color: #339933;">,</span> <a href="http://php.net/http_build_query"><span style="color: #990000;">http_build_query</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aVars</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #b1b100;">break</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">default</span><span style="color: #339933;">:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #b1b100;">throw</span> <span style="color: #000000; font-weight: bold;">new</span> Exception<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Error: Invalid HTTP method '<span style="color: #006699; font-weight: bold;">$method</span>' <span style="color: #006699; font-weight: bold;">$endpoint</span>&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #b1b100;">return</span> <span style="color: #009900; font-weight: bold;">null</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<br />
&nbsp; &nbsp;<span style="color: #000088;">$oRet</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> StdClass<span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">response</span> <span style="color: #339933;">=</span> <a href="http://php.net/json_decode"><span style="color: #990000;">json_decode</span></a><span style="color: #009900;">&#40;</span><a href="http://php.net/curl_exec"><span style="color: #990000;">curl_exec</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">status</span> &nbsp; <span style="color: #339933;">=</span> <a href="http://php.net/curl_getinfo"><span style="color: #990000;">curl_getinfo</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLINFO_HTTP_CODE<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<a href="http://php.net/curl_close"><span style="color: #990000;">curl_close</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp;<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">status</span> <span style="color: #339933;">==</span> <span style="color: #cc66cc;">401</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #666666; font-style: italic;">//if session has expired or bad login:</span><br />
&nbsp; &nbsp; &nbsp; <a href="http://php.net/header"><span style="color: #990000;">header</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Location: loginForm.php&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//change to match your login method</span><br />
&nbsp; &nbsp; &nbsp; <a href="http://php.net/die"><span style="color: #990000;">die</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">elseif</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">status</span> <span style="color: #339933;">!=</span> <span style="color: #cc66cc;">200</span> and <span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">status</span> <span style="color: #339933;">!=</span> <span style="color: #cc66cc;">201</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #666666; font-style: italic;">//if error</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">response</span> and <a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">response</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">error</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #b1b100;">print</span> <span style="color: #0000ff;">&quot;Error in <span style="color: #006699; font-weight: bold;">$pmServer</span>:<span style="color: #000099; font-weight: bold;">\n</span>Code: <span style="color: #006699; font-weight: bold;">{$oRet-&gt;response-&gt;error-&gt;code}</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">&quot;Message: <span style="color: #006699; font-weight: bold;">{$oRet-&gt;response-&gt;error-&gt;message}</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #b1b100;">print</span> <span style="color: #0000ff;">&quot;Error: HTTP status code: <span style="color: #006699; font-weight: bold;">$oRet-&gt;status</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<br />
&nbsp; &nbsp;<span style="color: #b1b100;">return</span> <span style="color: #000088;">$oRet</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<p>The <code>pmRestRequest()</code> function can be passed an access token to use when calling the REST endpoint. If the access token is not included as a parameter in the function, then <code>pmRestRequest()</code> uses the access token that is saved as a cookie. If the access token doesn't exist or has expired, then the <code>pmRestRequest()</code> function redirects to a web page where the user can enter their credentials to log into ProcessMaker. If doing automatic logins with saved credentials, then change this code to call <a href="https://wiki.processmaker.com/2.0/OAuth_2.0.html#PHP_example" title="OAuth 2.0">pmRestLogin()</a> directly.</p>

<p>After calling the REST endpoint, the <code>pmRestRequest()</code> function checks for errors in the response and prints them to inform the user of the problem. Then, it places the response and HTTP status code from the endpoint call in a object that is returned. When calling <code>pmRestRequest()</code>, check that the status code is <code>200</code> (or <code>201</code> for some endpoints) to make sure that there were no errors and then process the response.</p>

<p>For example, to call the <a href="https://wiki.processmaker.com/index.php/REST_API_Administration.html#Get_Users_List:_GET_.2Fusers" title="REST API Administration"><code>GET /api/1.0/{workspace}/users</code></a> endpoint using the <code>pmRestRequest()</code> function and print out a list of users:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$oRet</span> <span style="color: #339933;">=</span> pmRestRequest<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'GET'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'/api/1.0/workflow/users'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$oRet</span> and <span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">status</span> <span style="color: #339933;">==</span> <span style="color: #cc66cc;">200</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">response</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$oUser</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">print</span> <span style="color: #0000ff;">&quot;<span style="color: #006699; font-weight: bold;">{$oUser-&gt;usr_firstname}</span> <span style="color: #006699; font-weight: bold;">{$oUser-&gt;usr_lastname}</span> (<span style="color: #006699; font-weight: bold;">{$oUser-&gt;usr_username}</span>)<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<p>To log into ProcessMaker and then call the <code>pmRestRequest()</code> function using the access token that was obtained while logging in:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$oToken</span> <span style="color: #339933;">=</span> pmRestLogin<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;GHDPKQUUBPKFXVEQCCGFNKAQUTXCFCWT&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;5691904375509982564af14078068885&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;johndoe&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;p4ssw0rd&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$oRet</span> <span style="color: #339933;">=</span> pmRestRequest<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;GET&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'/api/1.0/workflow/users'</span><span style="color: #339933;">,</span> <span style="color: #009900; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #000088;">$oToken</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">access_token</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$oRet</span> and <span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">status</span> <span style="color: #339933;">==</span> <span style="color: #cc66cc;">200</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">response</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$oUser</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">print</span> <span style="color: #0000ff;">&quot;<span style="color: #006699; font-weight: bold;">{$oUser-&gt;usr_firstname}</span> <span style="color: #006699; font-weight: bold;">{$oUser-&gt;usr_lastname}</span> (<span style="color: #006699; font-weight: bold;">{$oUser-&gt;usr_username}</span>)<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<h3><span id="PHP_Calling_Rest_Endpoints_best_practices">PHP Calling REST Endpoints Best Practices </span></h3>
<p>These are examples of best ways to call REST endpoints:</p>
<ul>
<li><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#PHP_plugin">using a plugin</a></li>
<li><a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html#PHP_trigger">with triggers</a></li> 
</ul>

<h4><span id="PHP_plugin">Using the plugin</span></h4>
<p>In this option, create a plugin that has the functions you need. For this example, this plugin has the functions <span class="geshifilter"><code class="text geshifilter-text">pmRestLogin</code></span>, <span class="geshifilter"><code class="text geshifilter-text">pmRestRefresh</code></span> and <span class="geshifilter"><code class="text geshifilter-text">pmRestRequest</code></span>. Follow these steps to use this sample plugin:</p>
<p>1. <a href="../sites/default/files/pmRestRequest-1.0.tar">Download</a> this plugin as a sample with these three functions. This plugin contains the following class file that contain these functions:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">&lt;?php</span><br />
<br />
<span style="color: #000000; font-weight: bold;">global</span> <span style="color: #000088;">$pmServer</span><span style="color: #339933;">;</span><br />
<span style="color: #000000; font-weight: bold;">global</span> <span style="color: #000088;">$pmWorkspace</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000088;">$pmServer</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;http://10.100.64.7:13300&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$pmWorkspace</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;workflow&quot;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #666666; font-style: italic;">// Optional, these values can be here or can be send from case variables - Start</span><br />
<span style="color: #000000; font-weight: bold;">global</span> <span style="color: #000088;">$pmClientId</span><span style="color: #339933;">;</span><br />
<span style="color: #000000; font-weight: bold;">global</span> <span style="color: #000088;">$pmClientSecret</span><span style="color: #339933;">;</span><br />
<span style="color: #000000; font-weight: bold;">global</span> <span style="color: #000088;">$pmUsername</span><span style="color: #339933;">;</span><br />
<span style="color: #000000; font-weight: bold;">global</span> <span style="color: #000088;">$pmPassword</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000088;">$pmClientId</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;x-pm-local-client&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$pmClientSecret</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;179ad45c6ce2cb97cf1029e212046e81&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$pmUsername</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;admin&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$pmPassword</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;admin&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #666666; font-style: italic;">// Optional, these values can be here or can be send from case variables - End</span><br />
<br />
<br />
<span style="color: #000000; font-weight: bold;">function</span> pmRestLogin<span style="color: #009900;">&#40;</span><span style="color: #000088;">$clientId</span><span style="color: #339933;">,</span> <span style="color: #000088;">$clientSecret</span><span style="color: #339933;">,</span> <span style="color: #000088;">$username</span><span style="color: #339933;">,</span> <span style="color: #000088;">$password</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">global</span> <span style="color: #000088;">$pmServer</span><span style="color: #339933;">,</span> <span style="color: #000088;">$pmWorkspace</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$postParams</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'grant_type'</span> &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'password'</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'scope'</span> &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'*'</span><span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//set to 'view_process' if not changing the process</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'client_id'</span> &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$clientId</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'client_secret'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$clientSecret</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'username'</span> &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$username</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'password'</span> &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$password</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #000088;">$ch</span> <span style="color: #339933;">=</span> <a href="http://php.net/curl_init"><span style="color: #990000;">curl_init</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;<span style="color: #006699; font-weight: bold;">$pmServer</span>/<span style="color: #006699; font-weight: bold;">$pmWorkspace</span>/oauth2/token&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_TIMEOUT<span style="color: #339933;">,</span> <span style="color: #cc66cc;">30</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_POST<span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_POSTFIELDS<span style="color: #339933;">,</span> <span style="color: #000088;">$postParams</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_RETURNTRANSFER<span style="color: #339933;">,</span> <span style="color: #009900; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #000088;">$oToken</span> <span style="color: #339933;">=</span> <a href="http://php.net/json_decode"><span style="color: #990000;">json_decode</span></a><span style="color: #009900;">&#40;</span><a href="http://php.net/curl_exec"><span style="color: #990000;">curl_exec</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$httpStatus</span> <span style="color: #339933;">=</span> <a href="http://php.net/curl_getinfo"><span style="color: #990000;">curl_getinfo</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLINFO_HTTP_CODE<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <a href="http://php.net/curl_close"><span style="color: #990000;">curl_close</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$httpStatus</span> <span style="color: #339933;">!=</span> <span style="color: #cc66cc;">200</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">print</span> <span style="color: #0000ff;">&quot;Error in HTTP status code: <span style="color: #006699; font-weight: bold;">$httpStatus</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">return</span> <span style="color: #009900; font-weight: bold;">null</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; <span style="color: #b1b100;">elseif</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$oToken</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">error</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">print</span> <span style="color: #0000ff;">&quot;Error logging into <span style="color: #006699; font-weight: bold;">$pmServer</span>:<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">&quot;Error: &nbsp; &nbsp; &nbsp; <span style="color: #006699; font-weight: bold;">{$oToken-&gt;error}</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">&quot;Description: <span style="color: #006699; font-weight: bold;">{$oToken-&gt;error_description}</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; <span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//At this point $oToken-&gt;access_token can be used to call REST endpoints.</span><br />
<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//If planning to use the access_token later, either save the access_token</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//and refresh_token as cookies or save them to a file in a secure location.</span><br />
<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//If saving them as cookies:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <a href="http://php.net/setcookie"><span style="color: #990000;">setcookie</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;access_token&quot;</span><span style="color: #339933;">,</span> &nbsp;<span style="color: #000088;">$oToken</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">access_token</span><span style="color: #339933;">,</span> &nbsp;<a href="http://php.net/time"><span style="color: #990000;">time</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">+</span> <span style="color: #cc66cc;">86400</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <a href="http://php.net/setcookie"><span style="color: #990000;">setcookie</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;refresh_token&quot;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$oToken</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">refresh_token</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//refresh token doesn't expire</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <a href="http://php.net/setcookie"><span style="color: #990000;">setcookie</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;client_id&quot;</span><span style="color: #339933;">,</span> &nbsp; &nbsp; <span style="color: #000088;">$clientId</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <a href="http://php.net/setcookie"><span style="color: #990000;">setcookie</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;client_secret&quot;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$clientSecret</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//If saving to a file:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//file_put_contents(&quot;/secure/location/oauthAccess.json&quot;, json_encode($tokenData));</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #b1b100;">return</span> <span style="color: #000088;">$oToken</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<br />
<span style="color: #000000; font-weight: bold;">function</span> pmRestRefresh<span style="color: #009900;">&#40;</span><span style="color: #000088;">$clientId</span><span style="color: #339933;">=</span><span style="color: #009900; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #000088;">$clientSecret</span><span style="color: #339933;">=</span><span style="color: #009900; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #000088;">$refreshToken</span><span style="color: #339933;">=</span><span style="color: #009900; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">global</span> <span style="color: #000088;">$pmServer</span><span style="color: #339933;">,</span> <span style="color: #000088;">$pmWorkspace</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$clientId</span> &nbsp; &nbsp; <span style="color: #339933;">=</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$clientId</span> <span style="color: #339933;">===</span> <span style="color: #009900; font-weight: bold;">null</span> and <a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$_COOKIE</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'client_id'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp; ? <span style="color: #000088;">$_COOKIE</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'client_id'</span><span style="color: #009900;">&#93;</span> &nbsp; &nbsp; <span style="color: #339933;">:</span> <span style="color: #000088;">$clientId</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$clientSecret</span> <span style="color: #339933;">=</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$clientSecret</span> <span style="color: #339933;">===</span> <span style="color: #009900; font-weight: bold;">null</span> and <a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$_COOKIE</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'client_secret'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> ? <span style="color: #000088;">$_COOKIE</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'client_secret'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">:</span> <span style="color: #000088;">$clientSecret</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$refreshToken</span> <span style="color: #339933;">=</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$refreshToken</span> <span style="color: #339933;">===</span> <span style="color: #009900; font-weight: bold;">null</span> and <a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$_COOKIE</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'refresh_token'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> ? <span style="color: #000088;">$_COOKIE</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'refresh_token'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">:</span> <span style="color: #000088;">$refreshToken</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #000088;">$aVars</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'grant_type'</span> &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'refresh_token'</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'client_id'</span> &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$clientId</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'client_secret'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$clientSecret</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'refresh_token'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$refreshToken</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #000088;">$ch</span> <span style="color: #339933;">=</span> <a href="http://php.net/curl_init"><span style="color: #990000;">curl_init</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;<span style="color: #006699; font-weight: bold;">$pmServer</span>/<span style="color: #006699; font-weight: bold;">$pmWorkspace</span>/oauth2/token&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_TIMEOUT<span style="color: #339933;">,</span> <span style="color: #cc66cc;">30</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_POST<span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_POSTFIELDS<span style="color: #339933;">,</span> <span style="color: #000088;">$aVars</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_RETURNTRANSFER<span style="color: #339933;">,</span> <span style="color: #009900; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #000088;">$oToken</span> <span style="color: #339933;">=</span> <a href="http://php.net/json_decode"><span style="color: #990000;">json_decode</span></a><span style="color: #009900;">&#40;</span><a href="http://php.net/curl_exec"><span style="color: #990000;">curl_exec</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$httpStatus</span> <span style="color: #339933;">=</span> <a href="http://php.net/curl_getinfo"><span style="color: #990000;">curl_getinfo</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLINFO_HTTP_CODE<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <a href="http://php.net/curl_close"><span style="color: #990000;">curl_close</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$httpStatus</span> <span style="color: #339933;">!=</span> <span style="color: #cc66cc;">200</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">print</span> <span style="color: #0000ff;">&quot;Error in HTTP status code: <span style="color: #006699; font-weight: bold;">$httpStatus</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; <span style="color: #b1b100;">elseif</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$oToken</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">error</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">print</span> <span style="color: #0000ff;">&quot;Error logging into <span style="color: #006699; font-weight: bold;">$pmServer</span>:<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">&quot;Error: &nbsp; &nbsp; &nbsp; <span style="color: #006699; font-weight: bold;">{$oToken-&gt;error}</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">&quot;Description: <span style="color: #006699; font-weight: bold;">{$oToken-&gt;description}</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; <span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//Save access token as a cookie that expires in 86400 seconds:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <a href="http://php.net/setcookie"><span style="color: #990000;">setcookie</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;access_token&quot;</span><span style="color: #339933;">,</span> &nbsp;<span style="color: #000088;">$oToken</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">access_token</span><span style="color: #339933;">,</span> <a href="http://php.net/time"><span style="color: #990000;">time</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">+</span> <span style="color: #cc66cc;">86400</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//If saving to a file:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//file_put_contents(&quot;/secure/location/oauthAccess.json&quot;, json_encode($oToken));</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; <span style="color: #b1b100;">return</span> <span style="color: #000088;">$oToken</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<br />
<span style="color: #000000; font-weight: bold;">function</span> pmRestRequest<span style="color: #009900;">&#40;</span><span style="color: #000088;">$method</span><span style="color: #339933;">,</span> <span style="color: #000088;">$endpoint</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aVars</span> <span style="color: #339933;">=</span> <span style="color: #009900; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #000088;">$accessToken</span> <span style="color: #339933;">=</span> <span style="color: #009900; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">global</span> <span style="color: #000088;">$pmServer</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$accessToken</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$_COOKIE</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'access_token'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$accessToken</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$_COOKIE</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'access_token'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$accessToken</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #666666; font-style: italic;">//if the access token has expired</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//To check if the PM login session has expired: !isset($_COOKIE['PHPSESSID'])</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <a href="http://php.net/header"><span style="color: #990000;">header</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Location: loginForm.php&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//change to match your login method</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <a href="http://php.net/die"><span style="color: #990000;">die</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//add beginning / to endpoint if it doesn't exist:</span><br />
&nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$endpoint</span><span style="color: #009900;">&#41;</span> and <span style="color: #000088;">$endpoint</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">!=</span> <span style="color: #0000ff;">&quot;/&quot;</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$endpoint</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;/&quot;</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$endpoint</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #000088;">$ch</span> <span style="color: #339933;">=</span> <a href="http://php.net/curl_init"><span style="color: #990000;">curl_init</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$pmServer</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$endpoint</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_HTTPHEADER<span style="color: #339933;">,</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Authorization: Bearer &quot;</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$accessToken</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_TIMEOUT<span style="color: #339933;">,</span> <span style="color: #cc66cc;">30</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_RETURNTRANSFER<span style="color: #339933;">,</span> <span style="color: #009900; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$method</span> <span style="color: #339933;">=</span> <a href="http://php.net/strtoupper"><span style="color: #990000;">strtoupper</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$method</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #b1b100;">switch</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$method</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">&quot;GET&quot;</span><span style="color: #339933;">:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">break</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">&quot;DELETE&quot;</span><span style="color: #339933;">:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_CUSTOMREQUEST<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;DELETE&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">break</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">&quot;PUT&quot;</span><span style="color: #339933;">:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_CUSTOMREQUEST<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;PUT&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">&quot;POST&quot;</span><span style="color: #339933;">:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_POST<span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_POSTFIELDS<span style="color: #339933;">,</span> <a href="http://php.net/http_build_query"><span style="color: #990000;">http_build_query</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aVars</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">break</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">default</span><span style="color: #339933;">:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">throw</span> <span style="color: #000000; font-weight: bold;">new</span> Exception<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Error: Invalid HTTP method '<span style="color: #006699; font-weight: bold;">$method</span>' <span style="color: #006699; font-weight: bold;">$endpoint</span>&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">return</span> <span style="color: #009900; font-weight: bold;">null</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #000088;">$oRet</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> StdClass<span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">response</span> <span style="color: #339933;">=</span> <a href="http://php.net/json_decode"><span style="color: #990000;">json_decode</span></a><span style="color: #009900;">&#40;</span><a href="http://php.net/curl_exec"><span style="color: #990000;">curl_exec</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">status</span> &nbsp; <span style="color: #339933;">=</span> <a href="http://php.net/curl_getinfo"><span style="color: #990000;">curl_getinfo</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLINFO_HTTP_CODE<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <a href="http://php.net/curl_close"><span style="color: #990000;">curl_close</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">status</span> <span style="color: #339933;">==</span> <span style="color: #cc66cc;">401</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #666666; font-style: italic;">//if session has expired or bad login:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <a href="http://php.net/header"><span style="color: #990000;">header</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Location: loginForm.php&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//change to match your login method</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <a href="http://php.net/die"><span style="color: #990000;">die</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; <span style="color: #b1b100;">elseif</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">status</span> <span style="color: #339933;">!=</span> <span style="color: #cc66cc;">200</span> and <span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">status</span> <span style="color: #339933;">!=</span> <span style="color: #cc66cc;">201</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #666666; font-style: italic;">//if error</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">response</span> and <a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">response</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">error</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">print</span> <span style="color: #0000ff;">&quot;Error in <span style="color: #006699; font-weight: bold;">$pmServer</span>:<span style="color: #000099; font-weight: bold;">\n</span>Code: <span style="color: #006699; font-weight: bold;">{$oRet-&gt;response-&gt;error-&gt;code}</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">&quot;Message: <span style="color: #006699; font-weight: bold;">{$oRet-&gt;response-&gt;error-&gt;message}</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">print</span> <span style="color: #0000ff;">&quot;Error: HTTP status code: <span style="color: #006699; font-weight: bold;">$oRet-&gt;status</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #b1b100;">return</span> <span style="color: #000088;">$oRet</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<p>2. It is important for you to set the URL and workspace that you are using in the <span class="geshifilter"><code class="text geshifilter-text">$pmServer</code></span> and <span class="geshifilter"><code class="text geshifilter-text">$pmWorkspace</code></span> variables. After this plugin is installed the three functions are available for any trigger. This is a good way to avoid instancing.</p>
<p>3. The way to use this functions now would be the following:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>pmClientId <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;x-pm-local-client&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #339933;">@@</span>pmClientSecret <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;179ad45c6ce2cb97cf1029e212046e81&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #339933;">@@</span>pmUsername <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;admin&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #339933;">@@</span>pmPassword <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;admin&quot;</span><span style="color: #339933;">;</span><br />
<br />
<a href="http://php.net/var_dump"><span style="color: #990000;">var_dump</span></a><span style="color: #009900;">&#40;</span>pmRestLogin<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>pmClientId<span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>pmClientSecret<span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>pmUsername<span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>pmPassword<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<a href="http://php.net/die"><span style="color: #990000;">die</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<p>4. Change the variables values with your own information.</p><br>
<p>These variables can also be added like global variables like so:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">global</span> <span style="color: #000088;">$pmClientId</span><span style="color: #339933;">;</span><br />
<span style="color: #000000; font-weight: bold;">global</span> <span style="color: #000088;">$pmClientSecret</span><span style="color: #339933;">;</span><br />
<span style="color: #000000; font-weight: bold;">global</span> <span style="color: #000088;">$pmUsername</span><span style="color: #339933;">;</span><br />
<span style="color: #000000; font-weight: bold;">global</span> <span style="color: #000088;">$pmPassword</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000088;">$pmClientId</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;x-pm-local-client&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$pmClientSecret</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;179ad45c6ce2cb97cf1029e212046e81&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$pmUsername</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;admin&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$pmPassword</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;admin&quot;</span><span style="color: #339933;">;</span></div></div>
<p>Later you can use these lines in triggers this way:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">global</span> <span style="color: #000088;">$pmClientId</span><span style="color: #339933;">,</span> <span style="color: #000088;">$pmClientSecret</span><span style="color: #339933;">,</span> <span style="color: #000088;">$pmUsername</span><span style="color: #339933;">,</span> <span style="color: #000088;">$pmPassword</span><span style="color: #339933;">;</span><br />
<br />
<a href="http://php.net/var_dump"><span style="color: #990000;">var_dump</span></a><span style="color: #009900;">&#40;</span>pmRestLogin<span style="color: #009900;">&#40;</span><span style="color: #000088;">$pmClientId</span><span style="color: #339933;">,</span> <span style="color: #000088;">$pmClientSecret</span><span style="color: #339933;">,</span> <span style="color: #000088;">$pmUsername</span><span style="color: #339933;">,</span> <span style="color: #000088;">$pmPassword</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<a href="http://php.net/die"><span style="color: #990000;">die</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<h4><span id="PHP_trigger">Using the trigger</span></h4>
<p>You can call REST endpoints with triggers by using the following lines:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$pmRestRequest</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">function</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$method</span><span style="color: #339933;">,</span> <span style="color: #000088;">$pmServer</span><span style="color: #339933;">,</span> <span style="color: #000088;">$endpoint</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aVars</span> <span style="color: #339933;">=</span> <span style="color: #009900; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #000088;">$accessToken</span> <span style="color: #339933;">=</span> <span style="color: #009900; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">echo</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$pmServer</span><span style="color: #339933;">.</span><span style="color: #000088;">$endpoint</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$accessToken</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$_COOKIE</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'access_token'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$accessToken</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$_COOKIE</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'access_token'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$accessToken</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #666666; font-style: italic;">//if the access token has expired</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//To check if the PM login session has expired: !isset($_COOKIE['PHPSESSID'])</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <a href="http://php.net/header"><span style="color: #990000;">header</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Location: ./../login/login&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//change to match your login method</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <a href="http://php.net/die"><span style="color: #990000;">die</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//add beginning / to endpoint if it doesn't exist:</span><br />
&nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$endpoint</span><span style="color: #009900;">&#41;</span> and <span style="color: #000088;">$endpoint</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">!=</span> <span style="color: #0000ff;">&quot;/&quot;</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$endpoint</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;/&quot;</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$endpoint</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$ch</span> <span style="color: #339933;">=</span> <a href="http://php.net/curl_init"><span style="color: #990000;">curl_init</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_URL<span style="color: #339933;">,</span> <span style="color: #000088;">$pmServer</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$endpoint</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_HTTPHEADER<span style="color: #339933;">,</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Authorization: Bearer &quot;</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$accessToken</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_TIMEOUT<span style="color: #339933;">,</span> <span style="color: #cc66cc;">30</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_RETURNTRANSFER<span style="color: #339933;">,</span> <span style="color: #009900; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$method</span> <span style="color: #339933;">=</span> <a href="http://php.net/strtoupper"><span style="color: #990000;">strtoupper</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$method</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #b1b100;">switch</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$method</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">&quot;GET&quot;</span><span style="color: #339933;">:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_CUSTOMREQUEST<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;GET&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">break</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">&quot;DELETE&quot;</span><span style="color: #339933;">:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_CUSTOMREQUEST<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;DELETE&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">break</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">&quot;PUT&quot;</span><span style="color: #339933;">:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_CUSTOMREQUEST<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;PUT&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">&quot;POST&quot;</span><span style="color: #339933;">:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_POST<span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="http://php.net/curl_setopt"><span style="color: #990000;">curl_setopt</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLOPT_POSTFIELDS<span style="color: #339933;">,</span> <a href="http://php.net/http_build_query"><span style="color: #990000;">http_build_query</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aVars</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">break</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">default</span><span style="color: #339933;">:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">throw</span> <span style="color: #000000; font-weight: bold;">new</span> Exception<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Error: Invalid HTTP method '<span style="color: #006699; font-weight: bold;">$method</span>' <span style="color: #006699; font-weight: bold;">$endpoint</span>&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">return</span> <span style="color: #009900; font-weight: bold;">null</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$ret</span> <span style="color: #339933;">=</span> <a href="http://php.net/curl_exec"><span style="color: #990000;">curl_exec</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$oRet</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> StdClass<span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">response</span> <span style="color: #339933;">=</span> <a href="http://php.net/json_decode"><span style="color: #990000;">json_decode</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ret</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">status</span> &nbsp; <span style="color: #339933;">=</span> <a href="http://php.net/curl_getinfo"><span style="color: #990000;">curl_getinfo</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #339933;">,</span> CURLINFO_HTTP_CODE<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <a href="http://php.net/curl_close"><span style="color: #990000;">curl_close</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$ch</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">status</span> <span style="color: #339933;">==</span> <span style="color: #cc66cc;">401</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #666666; font-style: italic;">//if session has expired or bad login:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <a href="http://php.net/header"><span style="color: #990000;">header</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Location: ./../login/login&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//change to match your login method</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <a href="http://php.net/die"><span style="color: #990000;">die</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; <span style="color: #b1b100;">elseif</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">status</span> <span style="color: #339933;">!=</span> <span style="color: #cc66cc;">200</span> and <span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">status</span> <span style="color: #339933;">!=</span> <span style="color: #cc66cc;">201</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #666666; font-style: italic;">//if error</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">response</span> and <a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">response</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">error</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">print</span> <span style="color: #0000ff;">&quot;Error in <span style="color: #006699; font-weight: bold;">$pmServer</span>:<span style="color: #000099; font-weight: bold;">\n</span>Code: <span style="color: #006699; font-weight: bold;">{$oRet-&gt;response-&gt;error-&gt;code}</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">&quot;Message: <span style="color: #006699; font-weight: bold;">{$oRet-&gt;response-&gt;error-&gt;message}</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">print</span> <span style="color: #0000ff;">&quot;Error: HTTP status code: <span style="color: #006699; font-weight: bold;">$oRet-&gt;status</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; <span style="color: #b1b100;">return</span> <span style="color: #000088;">$oRet</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000088;">$oRet</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$pmRestRequest</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'GET'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;http://172.16.3.42:3220&quot;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'/api/1.0/workflow322/users'</span><span style="color: #339933;">,</span> <span style="color: #009900; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;8c6a4327b3125c41e7300bf3b95908c1503a8176&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$oRet</span> and <span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">status</span> <span style="color: #339933;">==</span> <span style="color: #cc66cc;">200</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$oRet</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">response</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$oUser</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">print</span> <span style="color: #0000ff;">&quot;<span style="color: #006699; font-weight: bold;">{$oUser-&gt;usr_firstname}</span> <span style="color: #006699; font-weight: bold;">{$oUser-&gt;usr_lastname}</span> (<span style="color: #006699; font-weight: bold;">{$oUser-&gt;usr_username}</span>)<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<p>Include this function in every trigger that needs to access the REST API. Change the information in <span class="geshifilter"><code class="text geshifilter-text">$pmRestRequest</code></span> with your information in order for this to work.</p>
<p>You can also create a public file and use this function from there.</p>   

<h2><span id="JavaScript" class="mw-headline">JavaScript</span></h2>

<p>In standard JavaScript, the <a href="http://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest" class="external text" rel="nofollow">XMLHttpRequest()</a> method can be used to call a ProcessMaker REST endpoint. XMLHttpRequest() is available in Internet Explorer 7+, FireFox, Chrome, Opera 8+, Safari 1.2+ and iCab 3.0+. In Internet Explorer 5, 5.5 and 6, <a href="http://msdn.microsoft.com/en-us/library/ie/7sw4ddf8%28v=vs.94%29.aspx" class="external text" rel="nofollow">ActiveXObject("Microsoft.XMLHTTP")</a> can be used instead of <code>XMLHttpRequest()</code>.</p>

<p>Examples are listed below of GET, POST, PUT and DELETE requests, but the easiest way to implement REST is to use the generic pmRestRequest() function below that can handle all the HTTP methods and does standard error checking.</p>

<h3><span id="GET_requests_2" class="mw-headline">GET Requests</span></h3>

<p>This JavaScript example creates a array of active users. It obtains the list of all the users in the workspace and stores it in an array named <code>aUsers</code>. Then it loops through the array and checks whether the user's status is "ACTIVE". If so, it adds the user's UID and username to a new array named <code>aActiveUsers</code>.</p>

<div class="geshifilter"><div class="javascript geshifilter-javascript" style="font-family:monospace;">pmServer <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;https://example.com&quot;</span><span style="color: #339933;">;</span> <span style="color: #006600; font-style: italic;">//set to address of your ProcessMaker server</span><br />
pmWorkspace <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;workflow&quot;</span><span style="color: #339933;">;</span> &nbsp;<span style="color: #006600; font-style: italic;">//set to the workspace of your ProcessMaker server</span><br />
<br />
<span style="color: #000066; font-weight: bold;">function</span> getUsers<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>getCookie<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;access_token&quot;</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">==</span> <span style="color: #003366; font-weight: bold;">false</span> <span style="color: #339933;">||</span> getCookie<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;PHPSESSID&quot;</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">==</span> <span style="color: #003366; font-weight: bold;">false</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; location.<span style="color: #660066;">window</span>.<span style="color: #660066;">href</span> <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;login.html&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">return</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">var</span> req <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">new</span> XMLHttpRequest<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;req.<span style="color: #660066;">open</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;GET&quot;</span><span style="color: #339933;">,</span> $pmServer <span style="color: #339933;">+</span> <span style="color: #3366CC;">&quot;/api/1.0/&quot;</span> <span style="color: #339933;">+</span> $pmWorkspace <span style="color: #339933;">+</span> <span style="color: #3366CC;">&quot;/users&quot;</span><span style="color: #339933;">,</span> <span style="color: #003366; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;req.<span style="color: #660066;">setRequestHeader</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;Authorization&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;Bearer &quot;</span> <span style="color: #339933;">+</span> getCookie<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'access_token'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp;req.<span style="color: #660066;">onreadystatechange</span> <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>req.<span style="color: #660066;">readyState</span><span style="color: #339933;">==</span><span style="color: #CC0000;">4</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>req.<span style="color: #660066;">status</span><span style="color: #339933;">==</span><span style="color: #CC0000;">200</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">var</span> aActiveUsers <span style="color: #339933;">=</span> <span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">var</span> aUsers <span style="color: #339933;">=</span> JSON.<span style="color: #660066;">parse</span><span style="color: #009900;">&#40;</span>req.<span style="color: #660066;">responseText</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">for</span> <span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">var</span> i <span style="color: #339933;">=</span> <span style="color: #CC0000;">0</span><span style="color: #339933;">;</span> i <span style="color: #339933;">&lt;</span> aUsers.<span style="color: #660066;">length</span><span style="color: #339933;">;</span> i<span style="color: #339933;">++</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>aUsers<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span>.<span style="color: #660066;">usr_status</span> <span style="color: #339933;">==</span> <span style="color: #3366CC;">&quot;ACTIVE&quot;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;aActiveUsers.<span style="color: #660066;">push</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #3366CC;">'uid'</span><span style="color: #339933;">:</span> &nbsp; &nbsp; &nbsp;aUsers<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span>.<span style="color: #660066;">usr_uid</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #3366CC;">'username'</span><span style="color: #339933;">:</span> aUsers<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span>.<span style="color: #660066;">usr_username</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">else</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;alert<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;Error status code: &quot;</span> <span style="color: #339933;">+</span> req.<span style="color: #660066;">status</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;req.<span style="color: #660066;">send</span><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<h3><span id="PUT_requests_2" class="mw-headline">PUT Requests</span></h3>

<p>To do PUT requests in JavaScript, place the parameters in an object and then use <a href="http://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent" class="external text" rel="nofollow">encodeURIComponent()</a> to encode them so they can be sent in the HTTP header with URL-encoding:</p>

<div class="geshifilter"><div class="javascript geshifilter-javascript" style="font-family:monospace;"><span style="color: #000066; font-weight: bold;">var</span> oVars <span style="color: #339933;">=</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #3366CC;">&quot;variable1&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;value1&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp;<span style="color: #3366CC;">&quot;variable2&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;value2&quot;</span><br />
<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000066; font-weight: bold;">for</span> <span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">var</span> v <span style="color: #000066; font-weight: bold;">in</span> oVars<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>oVars.<span style="color: #000066;">hasOwnProperty</span><span style="color: #009900;">&#40;</span>v<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; &nbsp; oVars<span style="color: #009900;">&#91;</span>v<span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> encodeURIComponent<span style="color: #009900;">&#40;</span>oVars<span style="color: #009900;">&#91;</span>v<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<p>The following example changes the status of a user to "VACATION" and sets the user who will replace this user when they goes on vacation.</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$pmServer</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;https://example.com&quot;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//set to your ProcessMaker address</span><br />
<span style="color: #000088;">$userId</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;75740355754dd28ba73d7d6082172937&quot;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set to the unique ID of a user</span><br />
<br />
<span style="color: #000000; font-weight: bold;">var</span> oVars <span style="color: #339933;">=</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; <span style="color: #0000ff;">'usr_status'</span><span style="color: #339933;">:</span> &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">&quot;VACATION&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; <span style="color: #0000ff;">'usr_replaced_by'</span><span style="color: #339933;">:</span> <span style="color: #0000ff;">&quot;14680180454ca4477335a27034362107&quot;</span><br />
<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #b1b100;">for</span> <span style="color: #009900;">&#40;</span><span style="color: #000000; font-weight: bold;">var</span> v in oVars<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span>oVars<span style="color: #339933;">.</span>hasOwnProperty<span style="color: #009900;">&#40;</span>v<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; &nbsp; oVars<span style="color: #009900;">&#91;</span>v<span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> encodeURIComponent<span style="color: #009900;">&#40;</span>oVars<span style="color: #009900;">&#91;</span>v<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<br />
<span style="color: #000000; font-weight: bold;">var</span> req <span style="color: #339933;">=</span> XMLHttpRequest<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
req<span style="color: #339933;">.</span>open<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'PUT'</span><span style="color: #339933;">,</span> pmServer <span style="color: #339933;">+</span> <span style="color: #0000ff;">'/api/1.0/workflow/user/'</span> <span style="color: #339933;">+</span> userId<span style="color: #339933;">,</span> <span style="color: #009900; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
req<span style="color: #339933;">.</span>setRequestHeader<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Authorization&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;Bearer &quot;</span> <span style="color: #339933;">+</span> getCookie<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;access_token&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000000; font-weight: bold;">var</span> sVars <span style="color: #339933;">=</span> JSON<span style="color: #339933;">.</span>stringify<span style="color: #009900;">&#40;</span>oVars<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
req<span style="color: #339933;">.</span>setRequestHeader<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Content-type'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'application/json; charset=utf-8'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
req<span style="color: #339933;">.</span>setRequestHeader<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Content-length'</span><span style="color: #339933;">,</span> sVars<span style="color: #339933;">.</span>length<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
req<span style="color: #339933;">.</span>onreadystatechange <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span>req<span style="color: #339933;">.</span>readyState<span style="color: #339933;">==</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span>req<span style="color: #339933;">.</span>responseText<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//use JSON.parse() to decode response text if the web browser supports it:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;oResult <span style="color: #339933;">=</span> <span style="color: #009900;">&#40;</span>JSON<span style="color: #009900;">&#41;</span> ? JSON<span style="color: #339933;">.</span>parse<span style="color: #009900;">&#40;</span>req<span style="color: #339933;">.</span>responseText<span style="color: #009900;">&#41;</span> <span style="color: #339933;">:</span> <a href="http://php.net/eval"><span style="color: #990000;">eval</span></a><span style="color: #009900;">&#40;</span>req<span style="color: #339933;">.</span>responseText<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span>req<span style="color: #339933;">.</span>status <span style="color: #339933;">==</span> <span style="color: #cc66cc;">401</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; window<span style="color: #339933;">.</span>location<span style="color: #339933;">.</span>href <span style="color: #339933;">=</span> login<span style="color: #339933;">.</span>html<span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">else</span> <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span>req<span style="color: #339933;">.</span>status <span style="color: #339933;">!=</span> <span style="color: #cc66cc;">200</span> <span style="color: #339933;">&amp;&amp;</span> req<span style="color: #339933;">.</span>status <span style="color: #339933;">!=</span> <span style="color: #cc66cc;">400</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; alert<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Error status code: &quot;</span> <span style="color: #339933;">+</span> req<span style="color: #339933;">.</span>status<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">else</span> <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span>req<span style="color: #339933;">.</span>status <span style="color: #339933;">==</span> <span style="color: #cc66cc;">400</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; alert<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Error Code: &quot;</span> <span style="color: #339933;">+</span> oResult<span style="color: #339933;">.</span>error<span style="color: #339933;">.</span>code <span style="color: #339933;">+</span> <span style="color: #0000ff;">&quot;<span style="color: #000099; font-weight: bold;">\n</span>Message: &quot;</span> <span style="color: #339933;">+</span> oResult<span style="color: #339933;">.</span>error<span style="color: #339933;">.</span>message<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//nothing required if success</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span><br />
req<span style="color: #339933;">.</span>send<span style="color: #009900;">&#40;</span><span style="color: #009900; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<h3><span id="JavaScript_pmRestRequest.28.29_function" class="mw-headline">JavaScript <code>pmRestRequest()</code> Function</span></h3>

<p>The best way to avoid code duplication is to create a generic JavaScript function called <code>pmRestRequest()</code> that can handle ProcessMaker REST requests. This function will set the HTTP headers depending on the HTTP method and then execute the call using XMLHttpRequest(). If an error occurs, it will display the error to the user.</p>

<div class="geshifilter"><div class="javascript geshifilter-javascript" style="font-family:monospace;"><span style="color: #000066; font-weight: bold;">var</span> pmServer <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;https://example.com&quot;</span><span style="color: #339933;">;</span> <span style="color: #006600; font-style: italic;">//set to IP address of ProcessMaker server</span><br />
<br />
<span style="color: #006600; font-style: italic;">//function to read cookie by name. If it returns false, then the cookie doesn't exist.</span><br />
<span style="color: #006600; font-style: italic;">//if it returns &quot;&quot;, then the cookie exists, but has no value.</span><br />
<span style="color: #000066; font-weight: bold;">function</span> getCookie<span style="color: #009900;">&#40;</span>name<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">function</span> escape<span style="color: #009900;">&#40;</span>s<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">return</span> s.<span style="color: #660066;">replace</span><span style="color: #009900;">&#40;</span><span style="color: #009966; font-style: italic;">/([.*+?\^${}()|\[\]\/\\])/g</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">'<span style="color: #000099; font-weight: bold;">\\</span>$1'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">var</span> match <span style="color: #339933;">=</span> document.<span style="color: #660066;">cookie</span>.<span style="color: #660066;">match</span><span style="color: #009900;">&#40;</span>RegExp<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'(?:^|;<span style="color: #000099; font-weight: bold;">\\</span>s*)'</span> <span style="color: #339933;">+</span> escape<span style="color: #009900;">&#40;</span>name<span style="color: #009900;">&#41;</span> <span style="color: #339933;">+</span> <span style="color: #3366CC;">'=([^;]*)'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">return</span> match <span style="color: #339933;">?</span> match<span style="color: #009900;">&#91;</span><span style="color: #CC0000;">1</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">:</span> <span style="color: #003366; font-weight: bold;">null</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<br />
<span style="color: #006600; font-style: italic;">//Global variables set by synchronous call to last REST endpoint:</span><br />
<span style="color: #000066; font-weight: bold;">var</span> oResponse &nbsp;<span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">null</span><span style="color: #339933;">;</span> <span style="color: #006600; font-style: italic;">//response object returned by REST endpoint and decoded with JSON.parse():</span><br />
<span style="color: #000066; font-weight: bold;">var</span> httpStatus <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">null</span><span style="color: #339933;">;</span> <span style="color: #006600; font-style: italic;">//HTTP status code of call to REST endpoint</span><br />
<br />
<span style="color: #006600; font-style: italic;">/*function to call a ProcessMaker endpoint. If a synchronous call, it sets the global variables<br />
httpStatus to the HTTP status code and oResponse to the decoded JSON response string.<br />
Parameters:<br />
&nbsp;method: &nbsp; &nbsp; &nbsp; &nbsp;HTTP method: &quot;GET&quot;, &quot;POST&quot;, &quot;PUT&quot; or &quot;DELETE&quot;<br />
&nbsp;endpoint: &nbsp; &nbsp; &nbsp;The PM endpoint, not including the server's address and port number.<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Ex: &quot;/api/1.0/workflow/cases&quot;<br />
&nbsp;asynchronous: &nbsp;Optional. Set to true if asynchronous request. If false (the default value), then<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; processing waits until the HTTP request completes, which means the browser freezes.<br />
&nbsp;oVars: &nbsp; &nbsp; &nbsp; &nbsp; Optional. Object containing variables to use in the request if &quot;POST&quot; or &quot;PUT&quot; method.<br />
&nbsp;func: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Optional. Custom function to be called after the endpoint request, whose first parameter<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; is the response object and the second parameter is the HTTP status code. */</span><br />
<span style="color: #000066; font-weight: bold;">function</span> pmRestRequest<span style="color: #009900;">&#40;</span>method<span style="color: #339933;">,</span> endpoint<span style="color: #339933;">,</span> asynchronous<span style="color: #339933;">,</span> oVars<span style="color: #339933;">,</span> func<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #006600; font-style: italic;">//set optional parameters:</span><br />
&nbsp; &nbsp;asynchronous <span style="color: #339933;">=</span> <span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">typeof</span> asynchronous <span style="color: #339933;">===</span> <span style="color: #3366CC;">'undefined'</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">?</span> <span style="color: #003366; font-weight: bold;">false</span> <span style="color: #339933;">:</span> asynchronous<span style="color: #339933;">;</span><br />
&nbsp; &nbsp;oParams &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=</span> <span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">typeof</span> oParams <span style="color: #339933;">===</span> <span style="color: #3366CC;">'undefined'</span><span style="color: #009900;">&#41;</span> &nbsp; &nbsp; &nbsp;<span style="color: #339933;">?</span> <span style="color: #003366; font-weight: bold;">null</span> &nbsp;<span style="color: #339933;">:</span> oParams<span style="color: #339933;">;</span><br />
&nbsp; &nbsp;func &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=</span> <span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">typeof</span> func <span style="color: #339933;">===</span> <span style="color: #3366CC;">'undefined'</span><span style="color: #009900;">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339933;">?</span> <span style="color: #003366; font-weight: bold;">null</span> &nbsp;<span style="color: #339933;">:</span> func<span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp;while <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span>getCookie<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;access_token&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;pmRestLogin<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">typeof</span> XMLHttpRequest <span style="color: #339933;">!=</span> <span style="color: #3366CC;">&quot;undefined&quot;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">var</span> req <span style="color: #339933;">=</span> XMLHttpRequest<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">else</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">try</span> <span style="color: #009900;">&#123;</span> &nbsp;<span style="color: #006600; font-style: italic;">//for IE 5, 5.5 &amp; 6:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">var</span> req <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">new</span> ActiveXObject<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;Microsoft.XMLHTTP&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">catch</span> <span style="color: #009900;">&#40;</span>e<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;alert <span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;Error: This browser does not support XMLHttpRequest.&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">return</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<br />
&nbsp; &nbsp;req.<span style="color: #660066;">open</span><span style="color: #009900;">&#40;</span>method<span style="color: #339933;">,</span> pmServer <span style="color: #339933;">+</span> endpoint<span style="color: #339933;">,</span> asynchronous<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;req.<span style="color: #660066;">setRequestHeader</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;Authorization&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;Bearer &quot;</span> <span style="color: #339933;">+</span> getCookie<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;access_token&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;sVars <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">null</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;method <span style="color: #339933;">=</span> method.<span style="color: #660066;">toUpperCase</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">trim</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">switch</span> <span style="color: #009900;">&#40;</span>method<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">case</span> <span style="color: #3366CC;">&quot;GET&quot;</span><span style="color: #339933;">:</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">case</span> <span style="color: #3366CC;">&quot;DELETE&quot;</span><span style="color: #339933;">:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">break</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">case</span> <span style="color: #3366CC;">&quot;PUT&quot;</span><span style="color: #339933;">:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #006600; font-style: italic;">//URL encode the values of any variables in oVars:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>oVars<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">for</span> <span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">var</span> v <span style="color: #000066; font-weight: bold;">in</span> oVars<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>oVars.<span style="color: #000066;">hasOwnProperty</span><span style="color: #009900;">&#40;</span>v<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; oVars<span style="color: #009900;">&#91;</span>v<span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> encodeURIComponent<span style="color: #009900;">&#40;</span>oVars<span style="color: #009900;">&#91;</span>v<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">case</span> <span style="color: #3366CC;">&quot;POST&quot;</span><span style="color: #339933;">:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">var</span> sVars <span style="color: #339933;">=</span> JSON.<span style="color: #660066;">stringify</span><span style="color: #009900;">&#40;</span>oVars<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;req.<span style="color: #660066;">setRequestHeader</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'Content-type'</span><span style="color: #339933;">,</span><span style="color: #3366CC;">'application/json; charset=utf-8'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;req.<span style="color: #660066;">setRequestHeader</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'Content-length'</span><span style="color: #339933;">,</span> sVars.<span style="color: #660066;">length</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">break</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">default</span><span style="color: #339933;">:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;alert<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;Error: Invalid HTTP method '&quot;</span> <span style="color: #339933;">+</span> url <span style="color: #339933;">+</span> <span style="color: #3366CC;">&quot;'.&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">return</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<br />
&nbsp; &nbsp;req.<span style="color: #660066;">onreadystatechange</span> <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>req.<span style="color: #660066;">readyState</span> <span style="color: #339933;">==</span> <span style="color: #CC0000;">4</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #006600; font-style: italic;">//the request is completed</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">var</span> status <span style="color: #339933;">=</span> req.<span style="color: #660066;">status</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">var</span> oResp <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">null</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>req.<span style="color: #660066;">responseText</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #006600; font-style: italic;">//use JSON.parse() to decode response text if the web browser supports it:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; oResp <span style="color: #339933;">=</span> <span style="color: #009900;">&#40;</span>JSON<span style="color: #009900;">&#41;</span> <span style="color: #339933;">?</span> JSON.<span style="color: #660066;">parse</span><span style="color: #009900;">&#40;</span>req.<span style="color: #660066;">responseText</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">:</span> eval<span style="color: #009900;">&#40;</span>req.<span style="color: #660066;">responseText</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span>asynchronous<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; httpStatus <span style="color: #339933;">=</span> status<span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; oResponse <span style="color: #339933;">=</span> oResp<span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>status <span style="color: #339933;">==</span> <span style="color: #CC0000;">401</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; window.<span style="color: #660066;">location</span>.<span style="color: #660066;">href</span> <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;login.html&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">return</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">else</span> <span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>oResp <span style="color: #339933;">&amp;&amp;</span> oResp.<span style="color: #660066;">error</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">var</span> msg <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;Error code: &quot;</span> <span style="color: #339933;">+</span> oResp.<span style="color: #660066;">error</span>.<span style="color: #660066;">code</span> <span style="color: #339933;">+</span> <span style="color: #3366CC;">&quot;<span style="color: #000099; font-weight: bold;">\n</span>Message: &quot;</span> <span style="color: #339933;">+</span> oResp.<span style="color: #660066;">error</span>.<span style="color: #660066;">message</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; alert<span style="color: #009900;">&#40;</span>msg<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #006600; font-style: italic;">//throw error if wanting to handle it:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #006600; font-style: italic;">//throw new Error(msg);</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">else</span> <span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>status <span style="color: #339933;">!=</span> <span style="color: #CC0000;">200</span> <span style="color: #339933;">&amp;&amp;</span> status <span style="color: #339933;">!=</span> <span style="color: #CC0000;">201</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; alert<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;HTTP status error: &quot;</span> <span style="color: #339933;">+</span> req.<span style="color: #660066;">status</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #006600; font-style: italic;">//throw error if wanting to handle it:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #006600; font-style: italic;">//throw new Error(&quot;HTTP status error: &quot; + req.status);</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>func<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> &nbsp;<span style="color: #006600; font-style: italic;">//call custom function to handle response:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; func<span style="color: #009900;">&#40;</span>oResp<span style="color: #339933;">,</span> status<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>asynchronous<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; req.<span style="color: #660066;">timeout</span> &nbsp; <span style="color: #339933;">=</span> <span style="color: #CC0000;">20000</span><span style="color: #339933;">;</span> &nbsp; <span style="color: #006600; font-style: italic;">//timeout after 20 seconds</span><br />
&nbsp; &nbsp; &nbsp; req.<span style="color: #660066;">ontimeout</span> <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> alert<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;Timed out calling &quot;</span> <span style="color: #339933;">+</span> $endpoint<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;req.<span style="color: #660066;">send</span><span style="color: #009900;">&#40;</span>sVars<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<h4><span id="Executing_pmRestRequest.28.29_asynchronously" class="mw-headline">Executing <code>pmRestRequest()</code> Asynchronously</span></h4>

<p>The REST endpoint can be called synchronously or asynchronously using the <code>pmRestRequest()</code> function. It is recommended to call it asynchronously, since it doesn't freeze the web browser while waiting for a response from the ProcessMaker server. If calling asynchronously and needing to process the response, then a custom function should be defined to process the response and pass this function as the last parameter of the <code>pmRestRequest()</code> function. The first parameter of the custom function should be the response object returned by the endpoint, and the second parameter should be the HTTP status code of the endpoint request.</p>

<p>For example, to print the list of users with "ACTIVE" status in the &lt;body&gt; of the current web page, define a custom function named <code>printUserList</code> and pass it as the last parameter in the <code>pmRestRequest()</code> function. Notice that the custom function's name <code>printUserList</code> is passed as a parameter, not <code>printUserList()</code>, since the function's reference is passed and not executed.</p>

<div class="geshifilter"><div class="javascript geshifilter-javascript" style="font-family:monospace;"><span style="color: #000066; font-weight: bold;">function</span> printUserList<span style="color: #009900;">&#40;</span>aUsers<span style="color: #339933;">,</span> status<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>status <span style="color: #339933;">!=</span> <span style="color: #CC0000;">200</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">return</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp;list <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;Active users:<span style="color: #000099; font-weight: bold;">\n</span>&lt;ol&gt;<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">for</span> <span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">var</span> i <span style="color: #339933;">=</span> <span style="color: #CC0000;">0</span><span style="color: #339933;">;</span> i <span style="color: #339933;">&lt;</span> aUsers.<span style="color: #660066;">length</span><span style="color: #339933;">;</span> i<span style="color: #339933;">++</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>aUsers<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span>.<span style="color: #660066;">usr_status</span> <span style="color: #339933;">==</span> <span style="color: #3366CC;">&quot;ACTIVE&quot;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;list <span style="color: #339933;">+=</span> <span style="color: #3366CC;">'&lt;li&gt;'</span> <span style="color: #339933;">+</span> aUsers<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span>.<span style="color: #660066;">usr_firstname</span> <span style="color: #339933;">+</span> <span style="color: #3366CC;">' '</span> <span style="color: #339933;">+</span> aUsers<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span>.<span style="color: #660066;">usr_lastname</span> <span style="color: #339933;">+</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #3366CC;">'('</span> <span style="color: #339933;">+</span> aUsers<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span>.<span style="color: #660066;">usr_username</span> <span style="color: #339933;">+</span> <span style="color: #3366CC;">')&lt;/li&gt;<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">var</span> p <span style="color: #339933;">=</span> document.<span style="color: #660066;">createElement</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'p'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;p.<span style="color: #660066;">innerHTML</span> <span style="color: #339933;">=</span> list <span style="color: #339933;">+</span> <span style="color: #3366CC;">&quot;&lt;/ol&gt;<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;document.<span style="color: #660066;">body</span>.<span style="color: #660066;">appendChild</span><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<br />
pmRestRequest<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'GET'</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">'/api/1.0/workspace/users'</span><span style="color: #339933;">,</span> <span style="color: #003366; font-weight: bold;">true</span><span style="color: #339933;">,</span> <span style="color: #003366; font-weight: bold;">null</span><span style="color: #339933;">,</span> printUserList<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #006600; font-style: italic;">//execute when page loads</span></div></div>

<h4><span id="Executing_pmRestRequest.28.29_synchronously" class="mw-headline">Executing <code>pmRestRequest()</code> Synchronously</span></h4>

<p>Executing the REST call asynchronously can be difficult if doing a whole series of actions in a row. In some instances it may necessary to execute REST requests synchronously so that things can happen in a sequence. Just remember that doing this will freeze the web browser while waiting for the response from the ProcessMaker server.</p>

<p>After <code>pmRestRequest()</code> is called synchronously, the HTTP status code from the endpoint request will be set in the global variable <code>httpStatus</code> and the response object will be placed in <code>oResponse</code>. Check these variables to see the result of the REST request.</p>

<p>For example:</p>

<div class="geshifilter"><div class="javascript geshifilter-javascript" style="font-family:monospace;">pmRestRequest<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'GET'</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">'/api/1.0/workspace/users'</span><span style="color: #339933;">,</span> <span style="color: #003366; font-weight: bold;">false</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>httpStatus <span style="color: #339933;">==</span> <span style="color: #CC0000;">200</span> and oResponse<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">var</span> aUsers <span style="color: #339933;">=</span> oResponse<span style="color: #339933;">;</span><br />
&nbsp; &nbsp;list <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;Active users:<span style="color: #000099; font-weight: bold;">\n</span>&lt;ol&gt;<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">for</span> <span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">var</span> i <span style="color: #339933;">=</span> <span style="color: #CC0000;">0</span><span style="color: #339933;">;</span> i <span style="color: #339933;">&lt;</span> aUsers.<span style="color: #660066;">length</span><span style="color: #339933;">;</span> i<span style="color: #339933;">++</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>aUsers<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span>.<span style="color: #660066;">usr_status</span> <span style="color: #339933;">==</span> <span style="color: #3366CC;">&quot;ACTIVE&quot;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;list <span style="color: #339933;">+=</span> <span style="color: #3366CC;">'&lt;li&gt;'</span> <span style="color: #339933;">+</span> aUsers<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span>.<span style="color: #660066;">usr_firstname</span> <span style="color: #339933;">+</span> <span style="color: #3366CC;">' '</span> <span style="color: #339933;">+</span> aUsers<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span>.<span style="color: #660066;">usr_lastname</span> <span style="color: #339933;">+</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #3366CC;">'('</span> <span style="color: #339933;">+</span> aUsers<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span>.<span style="color: #660066;">usr_username</span> <span style="color: #339933;">+</span> <span style="color: #3366CC;">')&lt;/li&gt;<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">var</span> p <span style="color: #339933;">=</span> document.<span style="color: #660066;">createElement</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'p'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;p.<span style="color: #660066;">innerHTML</span> <span style="color: #339933;">=</span> list <span style="color: #339933;">+</span> <span style="color: #3366CC;">&quot;&lt;/ol&gt;<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;document.<span style="color: #660066;">body</span>.<span style="color: #660066;">appendChild</span><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<h3><span id="Javascript_Calling_Rest_Endpoints_best_practices">Javascript Calling REST Endpoints Best Practices</span></h3>
<p>The easiest way to call REST endpoints is by using Javascript with Jquery. For example to obtain the access_token with the endpoint <span class="geshifilter"><code class="text geshifilter-text">http://[pm-server]/[workspace]/oauth2/token</code></span> (POST) use the following steps:</p>
<p>1. In a Javascript file use the following lines:</p>
<div class="geshifilter"><div class="javascript geshifilter-javascript" style="font-family:monospace;">url <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;http://{server}/{workspace}}/oauth2/token&quot;</span><span style="color: #339933;">;</span><br />
method <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;POST&quot;</span><span style="color: #339933;">;</span><br />
clientID <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;Your Client ID&quot;</span><span style="color: #339933;">;</span><br />
clientSecret <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;Your Client Secret&quot;</span><span style="color: #339933;">;</span><br />
user <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;Your username&quot;</span><span style="color: #339933;">;</span><br />
password <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;Your username&quot;</span><span style="color: #339933;">;</span><br />
<br />
$.<span style="color: #660066;">ajax</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; url<span style="color: #339933;">:</span> url<span style="color: #339933;">,</span><br />
&nbsp; &nbsp; type<span style="color: #339933;">:</span> method<span style="color: #339933;">,</span><br />
&nbsp; &nbsp; data<span style="color: #339933;">:</span> JSON.<span style="color: #660066;">stringify</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #3366CC;">&quot;grant_type&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;password&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #3366CC;">&quot;scope&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #3366CC;">&quot;client_id&quot;</span><span style="color: #339933;">:</span> clientID<span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #3366CC;">&quot;client_secret&quot;</span><span style="color: #339933;">:</span>clientSecret<span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #3366CC;">&quot;username&quot;</span><span style="color: #339933;">:</span> user<span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #3366CC;">&quot;password&quot;</span><span style="color: #339933;">:</span> password<br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; async<span style="color: #339933;">:</span> <span style="color: #003366; font-weight: bold;">false</span><span style="color: #339933;">,</span> <span style="color: #006600; font-style: italic;">//with false =&gt; sync ; true =&gt; async</span><br />
&nbsp; &nbsp; contentType<span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;application/json&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; success<span style="color: #339933;">:</span> <span style="color: #000066; font-weight: bold;">function</span> <span style="color: #009900;">&#40;</span>data<span style="color: #339933;">,</span> textStatus<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;console.<span style="color: #660066;">log</span><span style="color: #009900;">&#40;</span>data<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; error<span style="color: #339933;">:</span> <span style="color: #000066; font-weight: bold;">function</span> <span style="color: #009900;">&#40;</span>xhr<span style="color: #339933;">,</span> textStatus<span style="color: #339933;">,</span> errorThrown<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; console.<span style="color: #660066;">log</span><span style="color: #009900;">&#40;</span>textStatus<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<p>2. Replace the <span class="geshifilter"><code class="text geshifilter-text">{server}</code></span> and <span class="geshifilter"><code class="text geshifilter-text">{workspace}</code></span> with the IP address of your server and the workspace where you will use this REST API.</p>
<p>3. In the method section you need to use one of the three possible methods (POST, GET, PUT), for this example it would be the method POST.</p>
<p>4. In order to obtain the access_token we need the information of the <span class="geshifilter"><code class="text geshifilter-text">clientID</code></span> and <span class="geshifilter"><code class="text geshifilter-text">Client Secret</code></span>. Please check <a href="https://wiki.processmaker.com/2.0/OAuth_2.0.html#PHP_example">this</a> link and enter these information when you receive it.</p>
<p>5. Enter the user name and the password of the user with which you are going to request the access_token.</p>
<p>6. Use TRUE or FALSE if you want to sent asynchronously or synchronously the requests respectively. </p>
<p>Take in mind that if you chose synchronous requests that may temporarily lock the browser disabling any action while the request is active.</p>
<p>If you want to display in console you can use this lines instead:</p>
<div class="geshifilter"><div class="javascript geshifilter-javascript" style="font-family:monospace;">url <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;http://[server]/api/1.0/[workspace]/users&quot;</span><span style="color: #339933;">;</span><br />
method <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;GET&quot;</span><span style="color: #339933;">;</span><br />
accessToken <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;Your access Token&quot;</span><br />
callbackSuccess <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">function</span> <span style="color: #009900;">&#40;</span>data<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">var</span> i<span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">for</span> <span style="color: #009900;">&#40;</span>i<span style="color: #339933;">=</span><span style="color: #CC0000;">0</span><span style="color: #339933;">;</span> i<span style="color: #339933;">&lt;</span>data.<span style="color: #660066;">length</span> <span style="color: #339933;">;</span> i<span style="color: #339933;">++</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.<span style="color: #660066;">log</span><span style="color: #009900;">&#40;</span>data<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span>.<span style="color: #660066;">usr_firstname</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span><br />
<br />
callbackError <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">function</span> <span style="color: #009900;">&#40;</span>data<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; console.<span style="color: #660066;">error</span><span style="color: #009900;">&#40;</span>data<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<br />
$.<span style="color: #660066;">ajax</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; url<span style="color: #339933;">:</span> url<span style="color: #339933;">,</span><br />
&nbsp; &nbsp; type<span style="color: #339933;">:</span> method<span style="color: #339933;">,</span><br />
&nbsp; &nbsp; async<span style="color: #339933;">:</span> <span style="color: #003366; font-weight: bold;">false</span><span style="color: #339933;">,</span> <span style="color: #006600; font-style: italic;">// true</span><br />
&nbsp; &nbsp; beforeSend<span style="color: #339933;">:</span> <span style="color: #000066; font-weight: bold;">function</span> <span style="color: #009900;">&#40;</span>xhr<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; xhr.<span style="color: #660066;">setRequestHeader</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;Authorization&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;Bearer &quot;</span> <span style="color: #339933;">+</span> accessToken<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; contentType<span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;application/json&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; success<span style="color: #339933;">:</span> <span style="color: #000066; font-weight: bold;">function</span> <span style="color: #009900;">&#40;</span>data<span style="color: #339933;">,</span> textStatus<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; callbackSuccess<span style="color: #009900;">&#40;</span>data<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; error<span style="color: #339933;">:</span> <span style="color: #000066; font-weight: bold;">function</span> <span style="color: #009900;">&#40;</span>xhr<span style="color: #339933;">,</span> textStatus<span style="color: #339933;">,</span> errorThrown<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; callbackError<span style="color: #009900;">&#40;</span>textStatus<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<h2><span id="Source_code_for_endpoints" class="mw-headline">Source Code for Endpoints</span></h2>

<p>If in doubt about what parameters are accepted by an endpoint, all the endpoints and their GET parameters are listed in the file:<br>
&nbsp; &nbsp; &nbsp;<strong><tt><a href="https://wiki.processmaker.com/index.php/File_Locations.html#Installation_Directory">&lt;INSTALL-DIRECTORY&gt;</a>/shared/compiled/routes.php</tt></strong><font color=dimgrey> (version 3.0.1.8 and earlier)</font><br>
&nbsp; &nbsp; &nbsp;<strong><tt><a href="https://wiki.processmaker.com/index.php/File_Locations.html#Installation_Directory">&lt;INSTALL-DIRECTORY&gt;</a>/shared/sites/<font color=blue><i>workspace</i></font>/routes.php</tt></strong><font color=dimgrey> (version 3.1 and later)</font>
</p>


<p>The <strong><tt>routes.php</tt></strong> file is automatically generated the first time the REST API is called (or the first time it is called after the compiled cache is deleted).</p>

<p>The source code for the endpoints is located in the directory:<br> &nbsp; &nbsp; &nbsp;<strong><tt><a href="https://wiki.processmaker.com/index.php/File_Locations.html#Installation_Directory">&lt;INSTALL-DIRECTORY&gt;</a>/workflow/engine/src/ProcessMaker/Services/Api</tt></strong></p>

<p>When the endpoints are executed, they call internal classes and functions used in ProcessMaker. When in doubt about the functioning of an endpoint, check the source code of the endpoint and use a search tool such as <strong><code>grep</code></strong> to find the internal classes and functions that it calls.</p>

<p>For example, the endpoint <a href="https://wiki.processmaker.com/REST_API_Cases.html#Get_To_Do_Cases%3A_GET_.2Fcases"><code>GET /api/1.0/{workspace}/cases</code></a> calls the <code>Cases::doGetCasesListToDo()</code> method, which is defined in:<br> &nbsp; &nbsp; &nbsp;<strong><tt>workflow/engine/src/ProcessMaker/Services/Api/Cases.php</tt></strong></p>

<p>That method in turn calls the <code>Cases::getList()</code> method, which is defined in:<br> &nbsp; &nbsp; &nbsp;<strong><tt>workflow/engine/src/ProcessMaker/BusinessModel/Cases.php</tt></strong></p>

<p>That method in turn calls the <code>Applications::getAll()</code> method, which is defined in:<br> &nbsp; &nbsp; &nbsp;<strong><tt>workflow/engine/classes/class.applications.php</tt></strong></p>

<h2><span id="Testing_Endpoints" class="mw-headline">Testing Endpoints</span></h2>


<h3><span id="Using_Postman" class="mw-headline">Using Postman</span></h3>

<p>Postman is is a popular API client that makes it easy test ProcessMaker APIs.
To use it, first install the Google Chrome browser, and then install the Postman Chrome extension by going to the <a href="https://chrome.google.com/webstore/detail/postman/fhbjgbiflinjbdggehcddcbncdddomop?hl=en">Chrome Web Store</a> and clicking on the <b>Add to chrome</b> button.</p>
<p><img src="../sites/default/files/3.1RestPostmanGetPostman.png"></p>

<p>A window will be displayed asking for permission to add the extension. Click on the <b>Add app</b> button.</p>
<p><img src="../sites/default/files/3.1RestPostmanGetPostmanOk.png"></p>

<p>Once installed, the Chrome browser’s Apps page (chrome://apps/) will open displaying the Postman logo in the list of installed extensions. Click on the <b>Postman</b> icon.</p>

<p><img src="../sites/default/files/3.1RestPostmanOpenPostman.png"></p>

<p>On the login screen, the user can access Postman using his/her Google account, or by creating a new Postman account. To create or use an account later, just click the Take me straight to the app link.</p>

<p><img src="../sites/default/files/3.1RestPostmanLogin.png"></p>

<p>Once logged in, the Postman’s GUI will be displayed. In the top menu, there is a field where the API request can be entered. To the left of the request field, there is a menu where the desired method can be selected (GET, POST, PUT, DELETE, etc). Underneath the request field, there are tabs that can be used to add authorization credentials, headers, a body, and pre-request scripts. On the right side of the request field is the Save button, which saves your API requests for future use.</p>

<p><img src="../sites/default/files/3.1RestPostmanGUI.png"></p>

<p>Before performing any API requests, it is necessary to get an authorization token. Therefore, go to the Authorization tab, click on the <b>Type</b> dropdown and select <b>Oauth 2.0</b>.</p>

<p><img src="../sites/default/files/3.1RestPostmanAuthentication.png"></p>

<p>Click the <b>Get New Access Token</b> button.</p>

<p><img src="../sites/default/files/3.1RestPostmanGetNewToken.png"></p>

<p>The Get New Access Token window will be displayed.</p>

<p><img src="../sites/default/files/3.1RestPostmanGetNewAccessToken.png"></p>

<p>Where:</p>
<p><ul>
<li><b>Token Name:</b> A name that identifies the token.</li>
<li><b>Auth URL:</b> The authorization URL, which must be set to:<br>
<dd><dl><code>http://<font color="blue">&lt;processmaker-server&gt;</font>:<font color="blue">&lt;port&gt;</font>/<font color="blue">&lt;workspace&gt;</font>/oauth2/authorize</code></dl></dd>
</li>

<li><b>Access Token URL:</b> The URL where an access_token can be obtained, which must be set to:<br>
<dd><dl><code>http://<font color="blue">&lt;processmaker-server&gt;</font>:<font color="blue">&lt;port&gt;</font>/<font color="blue">&lt;workspace&gt;</font>/oauth2/token</code></dl></dd>
</li>
<li><b>Client ID:</b> The Client ID code, which was given when registering the application.</li>
<li><b>Client Secret:</b> The Client Secret code, which was given when registering for the application.</li>
<li><b>Scope (Optional):</b> The scope that determines which endpoints can be accessed: * (all endpoints), edit_process (access to endpoints to change processes), view_process (access to endpoints to view but not change processes).</li>
<li><b>Grant Type:</b> The grant type, which must be <b>authorization_code</b>. The <b>authorization_code</b> type is a two step process where the user logs in and then gives authorization to the external application to access ProcessMaker.</li>
<li><b>Request Access Token Locally:</b> If your OAuth2 provider is not publicly accessible (hosted locally or on your intranet), make sure the Request Access Token Locally option is checked.</li>
    </ul>
</p>

<p>Once the information is set, click the <b>Request Token</b> button. If everything is set up properly, the login screen of ProcessMaker will be displayed. Remember that to execute endpoints, the user's role must be assigned with the <a href="https://wiki.processmaker.com/3.1/Roles.html#PM_REST_API_APPLICATIONS">PM_FACTORY</a> permission. </p>

<p><img src="../sites/default/files/3.1RestPostmanGetAuthorization0.png"></p>

<p>After logging in, the window will be redirected to the OAuth2.0 authorization screen, where the user may authorize the external application to access ProcessMaker. If the user clicks on <b>Accept</b>, a token with the "bearer" type will be generated.</p>
<p><img src="../sites/default/files/3.1RestPostmanGetAuthorization.png"></p>

<p>The new authorization token will be listed under the Existing Tokens list, ready to be used to test a ProcessMaker endpoint.</p>

<p><img src="../sites/default/files/3.1RestPostmanGetAuthorization03.png"></p>

<p>Let's retrieve the list of a ProcessMaker workspaces using the <a href="https://wiki.processmaker.com/3.1/REST_API_Administration.html#Get_Roles_List:_GET_.2Froles">GET /roles</a> endpoint.</p>

<p>Enter the endpoint URL where it says "Enter request URL" and select the GET method on the left side of that field.</p>

<p><img src="../sites/default/files/3.1RestPostmanGetURL.png"></p>

<p>Then, go to the Authorization tab and select the token we got before. The token's information will be displayed at the right side of the window. Select "Header" in the <b>Add token to</b> dropdown and click on <b>Use Token</b>.</p>

<p><img src="../sites/default/files/3.1RestPostmanEndpoint.png"></p>

<p>The token key and value will be added inside the Header tab.</p>

<p><img src="../sites/default/files/3.1RestPostmanHeaderToken.png"></p>

<p>Click the <b>Send</b> button to call the endpoint. The response will be displayed in the Body section in JSON format.</p>

<p><img src="../sites/default/files/3.1RestPostmanGetResult.png"></p>

<p>Create a new role using the <a href="https://wiki.processmaker.com/3.1/REST_API_Administration.html#Create_Role:_POST_.2Frole">POST /role</a> endpoint. Change the method from GET to <b>POST</b> and change the URL to <tt>http://<font color="blue">&lt;processmaker-server&gt;</font>:<font color="blue">&lt;port&gt;</font>/api/1.0/<font color="blue">&lt;workflow&gt;</font>/role</tt>. The Body section will become available. Select <b>raw</b> to set the formatting type to <b>JSON (application/json)</b>.

<p><img src="../sites/default/files/3.1RestPostmanPOSTBodyTab.png"></p>

<p>Then, enter the JSON request body. To create a new role named "Tester", place a json code like the one below:</p>
<div class="geshifilter"><div class="text geshifilter-text" style="font-family:monospace;">{<br />
&nbsp; &nbsp; &quot;rol_code&quot;: &quot;PROCESSMAKER_TESTER&quot;,<br />
&nbsp; &nbsp; &quot;rol_name&quot;: &quot;Tester&quot;,<br />
&nbsp; &nbsp; &quot;rol_status&quot;: &quot;ACTIVE&quot;<br />
}</div></div>

<p>Once done, click the <b>Send</b> button to execute the request. The response will display information about the new role created.</p>
<p><img src="../sites/default/files/3.1RestPostmanPOSTCreateRole.png"></p>

<p>Some API endpoints use path variables, such as the <a href="https://wiki.processmaker.com/3.1/REST_API_Administration.html#Get_Role_Information:_GET_.2Frole.2F.7Brol_uid.7D">GET /role/{rol_uid}</a>, which has the path parameter {rol_uid}. This parameter can be set to ":rol_uid" to be automatically included in the Path editor. Click on the <b>Params</b> button to open the data editor and check that the parameter is already entered as the key. Update the value as needed. In this case, the value is the rol_uid of the rol created before. Then, click on <b>Send</b> and the information will be displayed in the Body section.</p>

<p><img src="../sites/default/files/3.1RestPostmanGETInformationRole.png"></p>

<p>In the case there is an error when executing an endpoint, the error message will be displayed in the Body section to help the user.</p>

<p><img src="../sites/default/files/3.1RestPostmanPOSTCreateRoleError.png"></p>

<h3><span id="Using_HttpRequester" class="mw-headline">Using HttpRequester</span></h3>
<p>HttpRequester is a simple tool that allows the user to test ProcessMaker endpoints. To use it, it is necesary to install <a href="https://www.mozilla.org/en-US/firefox/new/">Firefox</a>, then install the HttpRequester add-on by <a href="https://addons.mozilla.org/en-US/firefox/addon/http-request-maker" target="_blank"> searching for it add-on in Firefox</a> and clicking the <b>Add to Firefox</b> button.</p>

<p><img src="../sites/default/files/3.1HttpRequesterInstallFirefox.png"></p>

<p>A popup message will be displayed to confirm the installation. Click on <b>Install</b> to proceed.</p>

<p><img src="../sites/default/files/3.1HttpRequesterInstallFirefoxConfirmation.png"></p>

<p>After the installation, a popup message will ask the user for permission to restart the browser.</p>

<p><img src="../sites/default/files/3.1HttpRequesterInstallFirefoxRestart.png"></p>

<p>Once the browser is restarted, the HttpRequester icon will be shown next to the browser's search box.</p>

<p><img src="../sites/default/files/3.1HttpRequesterInstallFirefoxRestartIcon.png"></p>

<p>Click the icon to open the HttpRequester window.</p>

<p><img src="../sites/default/files/3.1HttpRequesterGUI.png"></p>

<p>Before testing any API endpoint, it is necessary to get an authorization token to access ProcessMaker endpoints. HttpRequester doesn't use Oauth2 to request a token with an authorization code grant type from ProcessMaker, such as in Postman. Nevertheless, the token can be obtained using the <a href="https://wiki.processmaker.com/3.1/OAuth_2.0.html#.22password.22_grant_type">password</a> grant type with the endpoint:</p>
<p>
<dl>
    <dd><b>POST</b> <code>http://<font color="blue">&lt;processmaker-server&gt;</font>:<font color="blue">&lt;port&gt;</font>/<font color="blue">&lt;workspace&gt;</font>/oauth2/token</code></dd>
</dl>
</p>
<p>In HttpRequester, place the URL shown above in the URL field.</p>

<p><img src="../sites/default/files/3.1HttpRequesterTokenURL.png"></p>

<p>Then, copy and paste the following code into the Content box, but do not forget to replace the information with your own user credentials and the client_id and the client_secret of your own application.</p>

<div class="geshifilter"><div class="text geshifilter-text" style="font-family:monospace;">{<br />
&nbsp; &nbsp;&quot;grant_type&quot;: &quot;password&quot;,<br />
&nbsp; &nbsp;&quot;scope&quot;: &quot;*&quot;,<br />
&nbsp; &nbsp;&quot;client_id&quot;:&quot;MGGIOIDNJZVFKYRWWKMLGCQLTGZUXOVA&quot;,<br />
&nbsp; &nbsp;&quot;client_secret&quot;:&quot;79986572259497effd91aa0016886131&quot;,<br />
&nbsp; &nbsp;&quot;username&quot;:&quot;travis&quot;,<br />
&nbsp; &nbsp;&quot;password&quot;:&quot;admin&quot;<br />
}</div></div>

<p>
<ul>
    <li><b>grant_type:</b> Must be set to <b>password</b>.</li>
    <li><b>scope:</b> The scope that determines which endpoints can be accessed: * (all endpoints), edit_process (access to endpoints to change processes), view_process (access to endpoints to view but not change processes).</li>
    <li><b>client_id:</b> The Client ID code, which was given when registering the application.</li>
    <li><b>client_secret:</b> The Client Secret code, which was given when registering for the application.</li>
    <li><b>username:</b> The username of the ProcessMaker user who will execute the endpoint.</li>
    <li><b>password:</b> The password of the user.</li>
</ul>
</p>

<p>Once the code is placed, verify that the Content Type is set to "application/json" and click on <b>Submit</b>.</p>
<p><img src="../sites/default/files/3.1HttpRequesterContentSend.png"></p>

<p>The request may take a few seconds. Once completed, the request will be listed in the History box.</p>

<p><img src="../sites/default/files/3.1HttpRequesterOKSend.png"></p>

<p>Double click on it to see the information retrieved.</p>

<p><img src="../sites/default/files/3.1HttpRequesteTokenRetrieved.png"></p>

<p>Copy the value of the access_token parameter (the number marked in blue in the image above), since this value will be used to test other endpoints.  In this example, the access token is "28fa356fcc2531a1108a0a82a7b65d620099b500".</p>

<p>Now, let's retrieve the list of roles in a ProcessMaker workspace using the <a href="https://wiki.processmaker.com/3.1/REST_API_Administration.html#Get_Roles_List:_GET_.2Froles">GET /roles</a> endpoint. Place the URL of the endpoint in the URL field, and in the Headers tab select the <b>Authorization</b> option in the Headers tab.</p>

<p><img src="../sites/default/files/3.1HttpRequesteGetRoles1.png"></p>

<p>The access token we retrieved before will be placed as the value of the header to give access to our request to the endpoint. In the Value field, write the word <i>Bearer</i> followed by the access token, as in:</p>

<div class="geshifilter"><div class="text geshifilter-text" style="font-family:monospace;">Bearer 28fa356fcc2531a1108a0a82a7b65d620099b500</div></div>

<p>Then, click on <b>Add</b>.</p>
<p><img src="../sites/default/files/3.1HttpRequesteGetRoles2.png"></p>

<p>The header will be added to the endpoint. Finally, click on <b>Submit</b> to make the request.</p>

<p><img src="../sites/default/files/3.1HttpRequesteGetRoles3.png"></p>

<p>The results of the request will be listed in the History box.</p>

<p><img src="../sites/default/files/3.1HttpRequesteGetRolesHistory.png"></p>

<p>Double click on it to see the role list.</p>

<p><img src="../sites/default/files/3.1HttpRequesteGetRolesResult.png"></p>

<p>To make another request, click on <b>New Request</b> and complete the fields using the endpoint's information. For example, to make a POST request to <a href="https://wiki.processmaker.com/3.0/Calling_REST_Endpoints.html">create a new role</a>, select the <b>POST</b> method, and place the endpoint URL and the request body in JSON format into the Content box. Finally, click on <b>Submit</b>.</p>

<p><img src="../sites/default/files/3.1HttpRequesteCreateRole1.png"></p>

<p>The request results will be listed. Double click on it to see the information.</p>
<p><img src="../sites/default/files/3.1HttpRequesteCreateRole2.png"></p>

<p>In cases where the endpoint has path parameters, the path parameters must be included manually. For example, to see the <a href="https://wiki.processmaker.com/3.1/REST_API_Administration.html#Get_Role_Information:_GET_.2Frole.2F.7Brol_uid.7D">information about  one particular role</a>, the rol_uid parameter will have to be included manually right after the URL, as shown in the image below.</p>
<p><img src="../sites/default/files/3.1HttpRequesteGetRole1.png"></p>

<p>Then, click on <b>Submit</b> as before and double click on the result listed to see the endpoint information.</p>
<p><img src="../sites/default/files/3.1HttpRequesteGetRole2.png"></p>
</div></div></div>  </div>

      <footer>
          </footer>
  
    </div>
  
</div> <!-- /.block -->
</div>
 <!-- /.region -->
      </section>
    </div>
  
      
    </div>

      
</div>

 <!---add diego--->
  <div id="download-app-section" class="download-app mobile-none">
			<div class="row">
				<div class="col-md-12">
					<div class="text_app">Download our app</div>
							<a href="https://itunes.apple.com/us/app/processmaker/id992576284?ls=1&mt=8" target="_blank">
								<img src="https://wiki.processmaker.com/themes/thecompany_responsive_theme/images/appstore.png">
							<a href="https://play.google.com/store/apps/details?id=com.colosa.processmaker" target="_blank">
								<img src="https://wiki.processmaker.com/themes/thecompany_responsive_theme/images/playstore.png">				
				</div>
			</div>
  </div>
  <!---end diego--->
<!----add diego----->    
		<div class="logo_processmaker"><a href="http://www.processmaker.com">
		<img src="https://wiki.processmaker.com/themes/thecompany_responsive_theme/images/logo_processmaker.png"></div>
<!----end diego----->
<div id="footer">
  <div id="footer_wrapper">
      </div>

  <div class="social-media-wrapper">
         <div id="social-media-icons">
       <ul>
       	<div class="text_contact">Contact us</div>
				<div class="text_number">+1-617-340-3377</div>
        <!--<li><a class="rss" href="/rss.xml">rss</a></li> <!--edit diego-->
        <li><a class="facebook" href="http://facebook.com/processmaker/" target="_blank" rel="me">facebook</a></li>
        <li><a class="twitter" href="https://twitter.com/processmaker" target="_blank" rel="me">twitter</a></li>
        <li><a class="gplus" href="https://www.google.com/+ProcessMakerOpenSource" target="_blank" rel="me">Gplus</a></li>
        <li><a class="linkedin" href="https://www.linkedin.com/groups?mostRecent=&gid=3970335&trk=my_groups-tile-flipgrp" target="_blank" rel="me">Linked in</a></li>
        <!--<li><a class="dribbble" href="http://dribbble.com" target="_blank" rel="me">Dribbble</a></li>
        <li><a class="vimeo" href="http://vimeo.com" target="_blank" rel="me">Vimeo</a></li>-->
        <li><a class="youtube" href="https://www.youtube.com/user/processmaker" target="_blank" rel="me">Youtube</a></li>
       </ul>
      </div>
      </div>
  
  <div class="footer_credit">
    <div class="footer_inner_credit">
           <div id="foot"><div class="region region-footer">
  <div id="block-block-2" class="block block-block">

      
  <div class="content">
    <p><font style="font-family:arial,sans-serif; font-size:15px; font-weight: none; color:#FFF">Automate your Workflow with Business Process Management<br>Software licensed under the <a 1px="" class="external text" href="http://www.gnu.org/licenses/agpl.html" rel="nofollow" style="padding-right: 13px; color:white;">GNU Affero General Public License version 3</a><br>Contact us:&nbsp;<a class="external free" href="mailto:community@processmaker.com" rel="nofollow" style="font-weight:bold;color:white;text-decoration:underline;">community@processmaker.com</a><br><a class="external free" href="https://www.processmaker.com/privacy-statement" rel="nofollow" style="font-weight:bold;color:white;text-decoration:underline;">Privacy Statement</a></font><br><font style="font-family:arial,sans-serif; font-size:15px; font-weight: none; color:#FFF">© Copyright 2000-2024 ProcessMaker Inc. All rights reserved.</font></p>
  </div>
  
</div> <!-- /.block -->
</div>
 <!-- /.region -->
</div>
         
   <!-- <div id="copyright">
      <p class="copyright">Copyright &copy; 2024, Documentation@ProcessMaker </p>
      <!--<p class="credits"> Developed by  <a href="http://www.zymphonies.com">Zymphonies</a></p>
      <div class="clear"></div>
    </div>-->
  </div>
  
  </div>
</div>

</div>

<script type="text/javascript">
  /* <![CDATA[ */
  document.write (
    '<img src="https://marketing.processmaker.com/acton/bn/3812/visitor.gif?ts='+ new Date().getTime()+ '&ref='+escape(document.referrer) + '">'
  );
  /* ]]> */
</script>
  
</div>
    <style>
    .center-div{
        width: 100%;        
        margin: 0 auto;
        z-index:10000;
        position:fixed;
        bottom: 0px;
        cursor:pointer;
    }
    .round-popup{
        margin:0 auto;
        font-family: 'Montserrat', sans-serif;
        font-size: 15px;
        font-weight: lighter;
        width: 412px;
        height: 50px;
        padding-top: 7px;
        text-align: center;
        position:relative;
    }
    .round-popup-button{
        position:absolute;
        top: 11px;
        right: 15px;
        background: transparent;
        border:none;
        font-size:15px;
        font-weight:normal;
        line-height:20px;
        width:20px;
        height:20px;
        padding:0;
    }
    .round-background-blue{
        background: url('http://www.processmaker.com/uploads/blue.png')no-repeat;
        color:white;
        
    }
    #box-pm31-button-blue{
        color: rgba(255, 255, 255, 0.5);
    }
    
    #box-pm31-button-blue:active,#box-pm31-button-blue:focus{
        border:none;
        outline:none;
    }
    .round-background-blue a{
        color: white!important;
        text-decoration: none;
        font-size: 15px;
        line-height:45px;
        font-family:Montserrat, sans-serif;
    }
    .round-background-blue span{
        font-weight: bold;
    }
    /*WHITE background*/
    .round-background-white{
        background: url('http://www.processmaker.com/uploads/white.png')no-repeat;
        background-position-x: -9px;        
        color: #3397E1;
    }
    .round-background-white a:hover{
        color: #3397E1!important;
        text-decoration: none;
        font-size: 15px;
    }
    #box-pm31-button-white{
        color: rgba(51, 151, 225, 0.7);
    }
</style>
    <div id="box-pm31" class="center-div" style="display:none;">
        <div class="round-popup round-background-blue">
            <a onclick="ga('send', 'event', 'WikiBlueBanner','click','PM31Release');" href="http://www.processmaker.com/download-processmaker-landing-page">
                <span>ProcessMaker 3.1</span> is Here! Download Now <span style="font-size:20px;font-weigth:normal;">»</span>
            </a>
            <button id="box-pm31-button-blue" class="round-popup-button">&times;</button>
        </div>
    </div>
    <script>

function pmCreateCookie(name,value,days) {
    if (days) {
        var date = new Date();
        date.setTime(date.getTime()+(days*24*60*60*1000));
        var expires = "; expires="+date.toGMTString();
    }
    else var expires = "";
    document.cookie = name+"="+value+expires+"; path=/";
}

function pmReadCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
}

function pmEraseCookie(name) {
    createCookie(name,"",-1);
}



     jQuery(document).ready(function( $ ) {
        $('#box-pm31-button-blue').click(function(e){
                e.stopPropagation();
                $('#box-pm31').slideUp('fast');
                pmCreateCookie('ppcookie','val',10);
            });
        });
        jQuery(window).load(function() {
            if(pmReadCookie('ppcookie') !== 'val'){
                //jQuery('#box-pm31').delay( 2000 ).slideDown('slow');
            }
        });
    </script>
<link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet">

<script type="text/javascript">
  (function() {
    window._pa = window._pa || {};
    // _pa.orderId = "myOrderId"; // OPTIONAL: attach unique conversion identifier to conversions
    // _pa.revenue = "19.99"; // OPTIONAL: attach dynamic purchase values to conversions
    // _pa.productId = "myProductId"; // OPTIONAL: Include product ID for use with dynamic ads
    var pa = document.createElement('script'); pa.type = 'text/javascript'; pa.async = true;
    pa.src = ('https:' == document.location.protocol ? 'https:' : 'http:') + "//tag.marinsm.com/serve/586a7ec3a2ae6b728400003d.js";
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(pa, s);
  })();
</script>

</body>
</html>
