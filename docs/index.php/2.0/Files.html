<!DOCTYPE html>
<head>
<meta charset="utf-8" />
<meta name="keywords" content="BPM, business process management, workflow, processmaker, business, BPM Windows, BPM Linux, wiki, BPM documentation, BPM FAQ, task documentation, BPM PHP, BPM Open Source, BPM Variables, BPM Installation, BPM Programming, BPM Elements, BPM Concepts, BPM Frequently Asked Questions, BPM 3.0, BPM News, Release notes, DynaForms, BPM Community, BPM Enterprise, BPM Mobile, BPM Responsive Web Design, User Manual, BPM Resources" />
<link rel="alternate" hreflang="en" href="../../index.html" />
<link rel="shortcut icon" href="https://wiki.processmaker.com/themes/thecompany_responsive_theme/favicon.ico" type="image/vnd.microsoft.icon" />
<meta name="description" content="ProcessMaker is commercial open source workflow and business process management software." />
<meta name="viewport" content="width=device-width" />
<meta name="Generator" content="Drupal 7 (http://drupal.org)" />
<link rel="canonical" href="Files.html" />
<link rel="shortlink" href="../../node/79.html" />
<title>2.0 - Files | Documentation@ProcessMaker</title>
<style type="text/css" media="all">
@import url("https://wiki.processmaker.com/modules/system/system.base.css?s743n7");
@import url("https://wiki.processmaker.com/modules/system/system.menus.css?s743n7");
@import url("https://wiki.processmaker.com/modules/system/system.messages.css?s743n7");
@import url("https://wiki.processmaker.com/modules/system/system.theme.css?s743n7");
</style>
<style type="text/css" media="all">
@import url("https://wiki.processmaker.com/modules/aggregator/aggregator.css?s743n7");
@import url("https://wiki.processmaker.com/modules/comment/comment.css?s743n7");
@import url("https://wiki.processmaker.com/modules/field/theme/field.css?s743n7");
@import url("https://wiki.processmaker.com/modules/node/node.css?s743n7");
@import url("https://wiki.processmaker.com/modules/search/search.css?s743n7");
@import url("https://wiki.processmaker.com/modules/toc_filter/toc_filter.css?s743n7");
@import url("https://wiki.processmaker.com/modules/user/user.css?s743n7");
@import url("https://wiki.processmaker.com/modules/views/css/views.css?s743n7");
</style>
<style type="text/css" media="all">
@import url("https://wiki.processmaker.com/sites/all/modules/colorbox/styles/default/colorbox_style.css?s743n7");
@import url("https://wiki.processmaker.com/modules/ctools/css/ctools.css?s743n7");
@import url("https://wiki.processmaker.com/sites/all/modules/geshifilter/geshifilter.css?s743n7");
@import url("https://wiki.processmaker.com/modules/panels/css/panels.css?s743n7");
@import url("https://wiki.processmaker.com/modules/nice_menus/css/nice_menus.css?s743n7");
@import url("https://wiki.processmaker.com/modules/nice_menus/css/nice_menus_default.css?s743n7");
@import url("https://wiki.processmaker.com/modules/fivestar/css/fivestar.css?s743n7");
</style>
<style type="text/css" media="all">
@import url("https://wiki.processmaker.com/themes/thecompany_responsive_theme/css/style.css?s743n7");
@import url("https://wiki.processmaker.com/themes/thecompany_responsive_theme/css/media.css?s743n7");
</style>
<script type="text/javascript" src="https://wiki.processmaker.com/modules/jquery_update/replace/jquery/1.9/jquery.min.js?v=1.9.1"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/misc/jquery.once.js?v=1.2"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/misc/drupal.js?s743n7"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/modules/nice_menus/js/jquery.bgiframe.js?v=2.1"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/modules/nice_menus/js/jquery.hoverIntent.js?v=0.5"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/modules/nice_menus/js/superfish.js?v=1.4.8"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/modules/nice_menus/js/nice_menus.js?v=1.0"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/modules/jquery_update/replace/ui/external/jquery.cookie.js?v=67fb34f6a866c40d0570"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/modules/jquery_update/replace/misc/jquery.form.min.js?v=2.69"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/misc/ajax.js?v=7.34"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/modules/jquery_update/js/jquery_update.js?v=0.0.1"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/modules/toc_filter/toc_filter.js?s743n7"></script>
<script type="text/javascript" src="../../sites/all/modules/colorbox/js/colorbox.js@s743n7"></script>
<script type="text/javascript" src="../../sites/all/modules/colorbox/styles/default/colorbox_style.js@s743n7"></script>
<script type="text/javascript" src="../../sites/all/modules/google_analytics/googleanalytics.js@s743n7"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
(function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga");ga("create", "UA-3380652-1", {"cookieDomain":"auto"});ga("set", "anonymizeIp", true);ga("send", "pageview");
//--><!]]>
</script>
<script type="text/javascript" src="https://wiki.processmaker.com/misc/progress.js?v=7.34"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/modules/fivestar/js/fivestar.ajax.js?s743n7"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/modules/fivestar/js/fivestar.js?s743n7"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/themes/thecompany_responsive_theme/js/jquery-1.10.2.min.js?s743n7"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/themes/thecompany_responsive_theme/js/jquery-ui.js?s743n7"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/themes/thecompany_responsive_theme/js/jquery-ui.min.js?s743n7"></script>
<script type="text/javascript" src="https://wiki.processmaker.com/themes/thecompany_responsive_theme/js/custom.js?s743n7"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"thecompany_responsive_theme","theme_token":"ylJuYiiKpU54ej1Egv3sShFvxd1I8yjCDNQyOQniqHo","jquery_version":"1.9","js":{"modules\/jquery_update\/replace\/jquery\/1.9\/jquery.min.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"modules\/nice_menus\/js\/jquery.bgiframe.js":1,"modules\/nice_menus\/js\/jquery.hoverIntent.js":1,"modules\/nice_menus\/js\/superfish.js":1,"modules\/nice_menus\/js\/nice_menus.js":1,"modules\/jquery_update\/replace\/ui\/external\/jquery.cookie.js":1,"modules\/jquery_update\/replace\/misc\/jquery.form.min.js":1,"misc\/ajax.js":1,"modules\/jquery_update\/js\/jquery_update.js":1,"modules\/toc_filter\/toc_filter.js":1,"sites\/all\/modules\/colorbox\/js\/colorbox.js":1,"sites\/all\/modules\/colorbox\/styles\/default\/colorbox_style.js":1,"sites\/all\/modules\/google_analytics\/googleanalytics.js":1,"0":1,"misc\/progress.js":1,"modules\/fivestar\/js\/fivestar.ajax.js":1,"modules\/fivestar\/js\/fivestar.js":1,"themes\/thecompany_responsive_theme\/js\/jquery-1.10.2.min.js":1,"themes\/thecompany_responsive_theme\/js\/jquery-ui.js":1,"themes\/thecompany_responsive_theme\/js\/jquery-ui.min.js":1,"themes\/thecompany_responsive_theme\/js\/custom.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"modules\/aggregator\/aggregator.css":1,"modules\/comment\/comment.css":1,"modules\/field\/theme\/field.css":1,"modules\/node\/node.css":1,"modules\/search\/search.css":1,"modules\/toc_filter\/toc_filter.css":1,"modules\/user\/user.css":1,"modules\/views\/css\/views.css":1,"sites\/all\/modules\/colorbox\/styles\/default\/colorbox_style.css":1,"modules\/ctools\/css\/ctools.css":1,"sites\/all\/modules\/geshifilter\/geshifilter.css":1,"modules\/panels\/css\/panels.css":1,"modules\/nice_menus\/css\/nice_menus.css":1,"modules\/nice_menus\/css\/nice_menus_default.css":1,"modules\/fivestar\/css\/fivestar.css":1,"themes\/thecompany_responsive_theme\/css\/style.css":1,"themes\/thecompany_responsive_theme\/css\/media.css":1}},"colorbox":{"opacity":"0.85","current":"{current} of {total}","previous":"\u00ab Prev","next":"Next \u00bb","close":"Close","maxWidth":"98%","maxHeight":"98%","fixed":true,"mobiledetect":true,"mobiledevicewidth":"480px","specificPagesDefaultValue":"admin*\nimagebrowser*\nimg_assist*\nimce*\nnode\/add\/*\nnode\/*\/edit\nprint\/*\nprintpdf\/*\nsystem\/ajax\nsystem\/ajax\/*"},"toc_filter_smooth_scroll_duration":"","googleanalytics":{"trackOutbound":1,"trackMailto":1,"trackDownload":1,"trackDownloadExtensions":"7z|aac|arc|arj|asf|asx|avi|bin|csv|doc(x|m)?|dot(x|m)?|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt(x|m)?|pot(x|m)?|pps(x|m)?|ppam|sld(x|m)?|thmx|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls(x|m|b)?|xlt(x|m)|xlam|xml|z|zip","trackColorbox":1},"nice_menus_options":{"delay":"800","speed":"slow"},"ajax":{"edit-vote--2":{"callback":"fivestar_ajax_submit","event":"change","url":"\/system\/ajax","submit":{"_triggering_element_name":"vote"}}}});
//--><!]]>
</script>
<!--[if lt IE 9]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','//connect.facebook.net/en_US/fbevents.js');
// Insert Your Facebook Pixel ID below.
fbq('init', '735235999992228');
fbq('track', 'PageView');
</script>
<!-- Insert Your Facebook Pixel ID below. -->
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=735235999992228&amp;ev=PageView&amp;noscript=1"
/></noscript>
<!-- End Facebook Pixel Code -->

</head>
<body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-79 node-type-community-edition">
    
<div class="wrap">

<div id="header_wrapper">
  <div id="inner_header_wrapper">

    <header id="header" role="banner">
      
      <div class="header_inner_wrapper">
        <div class="header_left">
                      <div id="logo">
              <a href="../../index.html" title="Home"><img src="../../sites/default/files/full-logo.png"/></a>
            </div>
                            <!--  <h1 id="site-title">
            <a href="/" title="Home">Documentation@ProcessMaker</a>
            <div id="site-description"></div>
          </h1> -->
            
        </div>
      </div>
      <div class="header_right">
          <div class="region region-search">
  <div id="block-search-form" class="block block-search">

        <h2 >_</h2>
    
  <div class="content">
    <form action="Files.html" method="post" id="search-block-form" accept-charset="UTF-8"><div><div class="container-inline">
    <div class="form-item form-type-textfield form-item-search-block-form">
  <label class="element-invisible" for="edit-search-block-form--2">Search </label>
 <input title="Enter the terms you wish to search for." placeholder="Search" type="text" id="edit-search-block-form--2" name="search_block_form" value="" size="15" maxlength="128" class="form-text" />
</div>
<div class="form-actions form-wrapper" id="edit-actions"><input type="submit" id="edit-submit" name="op" value="Search" class="form-submit" /></div><input type="hidden" name="form_build_id" value="form-C84UT_oIl8ZBFR_JtlkedzwFKaq8L717oSsMllOfUOw" />
<input type="hidden" name="form_id" value="search_block_form" />
</div>
</div></form>  </div>
  
</div> <!-- /.block -->
</div>
 <!-- /.region -->
                  <h1 class="page-title">2.0 - Files</h1>                <p class="page-title-suffix"></p>
                 <div style="margin-top: 5px;"></div>
      </div>
    </header>
    <div class="region-version">
      <span>Version: </span><ul><li><a href="../../3.2/File_control.html" class="">3.3</a></li><li><a href="../../3.2/File_control.html" class="">3.2</a></li><li><a href="../../3.1/File_control.html" class="">3.1</a></li><li><a href="../../3.0/File_control.html" class="">3.0</a></li><li><a  class="active-version">2.x</a></li></ul>    </div>
  </div>
</div>
<!-- <ul class="nice-menu nice-menu-down nice-menu-main-menu" id="nice-menu-0"><li class="menu-506 menu-path-node-1078 first odd "><a href="/PM_Classic" title="Learn how to develop business solutions in ProcessMaker Platform while maintaining your existing ProcessMaker 3 solutions in PM Classic: the perfect bridge between your new and existing solutions with a state-of--the-art BPM platform.">PM Classic</a></li>
<li class="menu-319 menu-path-processmakercom-tutorials  even "><a href="http://www.processmaker.com/tutorials" title="">Tutorials</a></li>
<li class="menu-320 menu-path-node-571  odd "><a href="/3.1/user_guide">User Guide</a></li>
<li class="menu-1138 menu-path-node-572  even "><a href="/3.1/developer_info">Developer Info</a></li>
<li class="menu-1197 menu-path-node-876  odd "><a href="/3.2/sys_administration">Sys Administration</a></li>
<li class="menu-1140 menu-path-node-236  even "><a href="/3.1/resources">Helpful Resources</a></li>
<li class="menu-1141 menu-path-node-554  odd "><a href="/Sitemap">Sitemap</a></li>
<li class="menu-1213 menu-path-sprocessmakergitbookio-processmaker-  even last"><a href="https://processmaker.gitbook.io/processmaker/" title="Read ProcessMaker Platform Spring 2023 documentation to learn more about the next generation of BPM.">ProcessMaker Platform</a></li>
</ul>
-->
  
  <div id="container">
    
    <div class="content-sidebar-wrap">

    <div id="content">

              <!-- <div id="breadcrumbs">
        <h2 class="element-invisible">You are here</h2><div class="breadcrumb"><a href="/">Home</a></div></div> -->
      
      <section id="post-content" role="main">
                                        <div class="region region-content">
  <div id="block-system-main" class="block block-system">

      
  <div class="content">
                          <span property="dc:title" content="2.0 - Files" class="rdf-meta element-hidden"></span>  
      
    
  <div class="content node-community-edition">
    <div class="field field-name-field-how-useful field-type-fivestar field-label-above"><div class="field-label">Please rate how useful you found this document:&nbsp;</div><div class="field-items"><div class="field-item even"><form class="fivestar-widget" action="Files.html" method="post" id="fivestar-custom-widget" accept-charset="UTF-8"><div><div  class="clearfix fivestar-average-text fivestar-average-stars fivestar-form-item fivestar-default"><div class="form-item form-type-fivestar form-item-vote">
 <div class="form-item form-type-select form-item-vote">
 <select id="edit-vote--2" name="vote" class="form-select"><option value="-">Select rating</option><option value="20">Give 2.0 - Files 1/5</option><option value="40">Give 2.0 - Files 2/5</option><option value="60" selected="selected">Give 2.0 - Files 3/5</option><option value="80">Give 2.0 - Files 4/5</option><option value="100">Give 2.0 - Files 5/5</option></select>
<div class="description"><div class="fivestar-summary fivestar-summary-average-count"><span class="average-rating">Average: <span >2.7</span></span> <span class="total-votes">(<span >6</span> votes)</span></div></div>
</div>

</div>
</div><input class="fivestar-submit form-submit" type="submit" id="edit-fivestar-submit" name="op" value="Rate" /><input type="hidden" name="form_build_id" value="form-RVNjzsGaco6UppcidzWrxPIkjk6J5u0bpDT6ueaPrto" />
<input type="hidden" name="form_id" value="fivestar_custom_widget" />
</div></form></div></div></div><div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><div style="float: right; margin-left: 5px; background-color: #f9f9f9; border: 1px solid #aaaaaa; padding: 5px;"><center><strong>Contents:</strong> [<a href="Files.html#" onclick="var el = document.getElementById('toc');
        var txt = ('innerText' in el)? 'innerText' : 'textContent';
        if (el.style.display=='none') { 
           el.style.display = '';
           document.getElementById('hideLabel')[txt] = 'hide';
        }
        else {
	        el.style.display = 'none';
           document.getElementById('hideLabel')[txt] = 'show';
        }"><span id="hideLabel">hide</span></a>]</b></center><div id="toc" ><ol class="toc">
<li class="toc"><a href="Files.html#Overview">Overview</a></li>
<li class="toc"><a href="Files.html#Properties">Properties</a></li>
<ol class="toc">
<li class="toc"><a href="Files.html#Input">Input</a></li>
</ol>
<li class="toc"><a href="Files.html#File_Access_and_Storage">File Access and Storage</a></li>
<li class="toc"><a href="Files.html#Accessing_Files_with_JavaScript">Accessing Files with JavaScript</a></li>
<ol class="toc">
<li class="toc"><a href="Files.html#Opening_the_contents_of_a_file">Opening the contents of a file</a></li>
</ol>
<li class="toc"><a href="Files.html#Accessing_Files_with_PHP">Accessing Files with PHP</a></li>
<ol class="toc">
<li class="toc"><a href="Files.html#Inserting_Uploaded_Files_in_an_Email">Inserting Uploaded Files in an Email</a></li>
<li class="toc"><a href="Files.html#Inserting_Uploaded_Files_in_a_Database">Inserting Uploaded Files in a Database</a></li>
<li class="toc"><a href="Files.html#Importing_an_Uploaded_CSV_File_into_a_Grid">Importing an Uploaded CSV File into a Grid</a></li>
</ol>
</div></div>


<h2><span id="Overview">Overview</span></h2>

<p><img alt="" height="23" src="../../sites/default/files/DynaFormFile.gif"> File objects allow files to be uploaded to a DynaForm and attached to the current case. Clicking on a file object opens a dialog box to upload a file.</p>
<h2><span id="Properties">Properties</span></h2>
<ul><li><a href="Common_Field_Properties.html#Field_Name" title="2.0/Common Field Properties">Field Name</a><font color="red"> *Required</font></li><li><a href="Common_Field_Properties.html#Label" title="2.0/Common Field Properties">Label</a></li><li><a href="Files.html#Input">Input</a></li></ul><p><strong>Behavior</strong></p>
<ul><li><a href="Common_Field_Properties.html#Required" title="2.0/Common Field Properties">Required</a></li></ul>
<h3><span id="Input">Input</span></h3><p>Beginning with version 1.2-2467, it is possible to upload <a href="Input_Documents.html" title="2.0/Input Documents">Input Documents</a> from inside a DynaForm. Select the Input Document in the <strong>Input</strong> property, and all uploaded files will be treated as that Input Document.</p><p><strong>XML Definition:</strong></p><p><tt>&lt;<i>NAME</i> ... <strong>input="<i>INPUT-DOCUMENT-UID</i>"</strong> ...&gt;...<!--<i-->NAME&gt;</tt></p>
<h2><span id="File_Access_and_Storage">File Access and Storage</span></h2><p>Uploaded input documents are available for review afterwards by clicking on the <strong>STEPS</strong> tab under the <strong>CASES</strong> menu then clicking on [+] next to the name of the Input Document to see the list of documents which have been uploaded thus far in the case. All other uploaded files (which are not Input Documents) are available to the user by clicking on the <strong>INFORMATION</strong> tab under the <strong>CASES</strong> menu. In the "Information" sidebar click on the <strong>Uploaded Documents</strong> button to see all the documents uploaded during the case. (Remember that a user must either be the currently assigned user or have been assigned Process Permissions to be able to access a case.)</p><p>Since uploaded files are stored as files in the harddrive, their size can be as large as allowed by the operating system and harddrive format. Nonetheless, PHP by default is configured to allow the upload of files no larger than 2MB. To increase the maximum size of uploaded files, <a href="../Changing_the_ProcessMaker_Configuration.html#Editing_the_PHP_configuration" title="Changing the ProcessMaker Configuration">edit your <strong><tt>php.ini</tt></strong> file</a> to allow for larger file uploads.</p><p>Look for the "File Uploads" section and set <tt>file_uploads = On</tt> and increase the size of <tt>upload_max_filesize</tt>:</p>
<codeblock>;;;;;;;;;;;;;;;;
; File Uploads ;
;;;;;;;;;;;;;;;;
; Whether to allow HTTP file uploads.
file_uploads = On
; Temporary directory for HTTP uploaded files (will use system default if not specified).
;upload_tmp_dir =
; Maximum allowed size for uploaded files.
upload_max_filesize = 2M
</codeblock>

<p>Uploaded files are passed to the ProcessMaker server as POST data, whose maximum size by default is 8MB. If larger files need to be uploaded, also increase the size of <tt>post_max_size</tt>:</p>

<codeblock>; Maximum size of POST data that PHP will accept.
post_max_size = 8M
</codeblock>

<p>Uploaded files are stored in the <strong><tt>sites/<workspace>/files/<case-uid>/</case-uid></workspace></tt></strong> directory. For the default "workflow" workspace, files are generally found at:<br><strong>Linux/UNIX:</strong></p>
<p><span>/opt/processmaker/shared/sites/workflow/files/&lt;CASE-UID&gt;/</span><tt><case-uid></case-uid></tt></p>
<p><strong>Windows:</strong><br>If manually installed or installed in version 1.6-4260 or later:</p>
<p><span>C:\Program Files\ProcessMaker\processmaker\shared\sites\workflow\files\&lt;CASE-UID&gt;\</span><tt><case-uid></case-uid></tt></p>
<p>If installed before version 1.6-4260:</p>
<p><span>C:\Program Files\ProcessMaker\apps\processmaker\shared\workflow_data\sites\workflow\files\&lt;CASE-UID&gt;\</span><tt><case-uid></case-uid></tt></p>
<p>Uploaded files retain their extension, but they are saved with the name of their UID, which is a string of 32 hexadecimal numbers to uniquely identify objects in ProcessMaker. For instance a file called "<tt>myinvoice.pdf</tt>" might get renamed to "<tt>6772460934ab6834e131308085665262.pdf</tt>".</p>
<h2><span id="Accessing_Files_with_JavaScript">Accessing Files with JavaScript</span></h2>

<p>To validate the filename which is uploaded to a file field, read its <strong><tt>value</tt></strong> property. For example, the following JavaScript code ensures that only files which have an extension of .txt, .htm or .html are uploaded to a file field named "reportFile":</p>
<div class="geshifilter"><div class="javascript geshifilter-javascript" style="font-family:monospace;">getField<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;reportFile&quot;</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">onchange</span> <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">var</span> re <span style="color: #339933;">=</span> <span style="color: #009966; font-style: italic;">/(?:\.([^.]+))?$/</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">var</span> ext <span style="color: #339933;">=</span> re.<span style="color: #660066;">exec</span><span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">value</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#91;</span><span style="color: #CC0000;">1</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>ext <span style="color: #339933;">==</span> <span style="color: #3366CC;">&quot;txt&quot;</span> <span style="color: #339933;">||</span> ext <span style="color: #339933;">==</span> <span style="color: #3366CC;">&quot;html&quot;</span> <span style="color: #339933;">||</span> ext <span style="color: #339933;">==</span> <span style="color: #3366CC;">&quot;htm&quot;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">return</span> <span style="color: #003366; font-weight: bold;">true</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">else</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; alert<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;Error: Only files with an extension of .txt, .html or .htm are allowed!&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">value</span> <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;&quot;</span><span style="color: #339933;">;</span> <span style="color: #006600; font-style: italic;">//reset the file to empty.</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">return</span> <span style="color: #003366; font-weight: bold;">false</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<h3><span id="Opening_the_contents_of_a_file">Opening the contents of a file</span></h3>
<p>The <a class="external text" href="http://dev.w3.org/2006/webapi/FileAPI/" rel="nofollow">File API</a> can be used to open files which have been uploaded to a file field, however, this API is only available Firefox 7+, Internet Explorer 10.0+, Chrome 13+ and Safari 6.0+. For earlier versions of Internet Explorer, ActiveX can be used if it is enabled.</p>
<p>In this example, JavaScript is used to open the contents of a file uploaded to a file field named "reportFile". It searches whether the file contains the string "monthly report". If so, it allows the file to be used. Otherwise, it clears the file field and displays a message telling the user that the file doesn't contain "monthly report" or can't be opened.</p>
<div class="geshifilter"><div class="javascript geshifilter-javascript" style="font-family:monospace;">getField<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;upload&quot;</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">onchange</span> <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">value</span> <span style="color: #339933;">==</span> <span style="color: #3366CC;">&quot;&quot;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">return</span> <span style="color: #003366; font-weight: bold;">true</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">var</span> file <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">files</span><span style="color: #009900;">&#91;</span><span style="color: #CC0000;">0</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #006600; font-style: italic;">//if the File API is supported: Firefox 7+, IE 10+, Chrome 13+, Sarfari 6+</span><br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>file<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">var</span> reader <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">new</span> FileReader<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; reader.<span style="color: #660066;">readAsText</span><span style="color: #009900;">&#40;</span>file<span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;UTF-8&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; reader.<span style="color: #660066;">onload</span> <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">function</span> <span style="color: #009900;">&#40;</span>evt<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">var</span> contents <span style="color: #339933;">=</span> evt.<span style="color: #660066;">target</span>.<span style="color: #660066;">result</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #006600; font-style: italic;">//if case insensitive regex search doesn't find &quot;monthly report&quot;:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>contents.<span style="color: #660066;">search</span><span style="color: #009900;">&#40;</span><span style="color: #009966; font-style: italic;">/monthly report/i</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">==</span> <span style="color: #339933;">-</span><span style="color: #CC0000;">1</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; alert<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;Error: File '&quot;</span> <span style="color: #339933;">+</span> file.<span style="color: #660066;">name</span> <span style="color: #339933;">+</span> <span style="color: #3366CC;">&quot;' does not contain 'Monthly report'.&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; getField<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;reportFile&quot;</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">value</span> <span style="color: #339933;">!=</span> <span style="color: #3366CC;">&quot;&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">return</span> <span style="color: #003366; font-weight: bold;">false</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">else</span> <span style="color: #000066; font-weight: bold;">return</span> <span style="color: #003366; font-weight: bold;">true</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; reader.<span style="color: #660066;">onerror</span> <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">function</span> <span style="color: #009900;">&#40;</span>evt<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;alert<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;Error reading file '&quot;</span> <span style="color: #339933;">+</span> file.<span style="color: #660066;">name</span> <span style="color: #339933;">+</span> <span style="color: #3366CC;">&quot;'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;getField<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;reportFile&quot;</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">value</span> <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">return</span> <span style="color: #003366; font-weight: bold;">false</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">else</span> <span style="color: #009900;">&#123;</span> <span style="color: #006600; font-style: italic;">// try the IE method</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">try</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">var</span> fso &nbsp;<span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">new</span> ActiveXObject<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;Scripting.FileSystemObject&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">var</span> fh <span style="color: #339933;">=</span> fso.<span style="color: #660066;">OpenTextFile</span><span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">value</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">var</span> contents <span style="color: #339933;">=</span> fh.<span style="color: #660066;">ReadAll</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;fh.<span style="color: #660066;">Close</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>contents.<span style="color: #660066;">search</span><span style="color: #009900;">&#40;</span><span style="color: #009966; font-style: italic;">/monthly report/i</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">==</span> <span style="color: #339933;">-</span><span style="color: #CC0000;">1</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; alert<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;Error: File '&quot;</span> <span style="color: #339933;">+</span> <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">value</span> <span style="color: #339933;">+</span> <span style="color: #3366CC;">&quot;' does not contain 'Monthly report'.&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">value</span> <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">return</span> <span style="color: #003366; font-weight: bold;">false</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">else</span> <span style="color: #000066; font-weight: bold;">return</span> <span style="color: #003366; font-weight: bold;">true</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">catch</span> <span style="color: #009900;">&#40;</span>Exception<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;alert<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;Error: Cannot open file '&quot;</span> <span style="color: #339933;">+</span> <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">value</span> <span style="color: #339933;">+</span> <span style="color: #3366CC;">&quot;'.&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">value</span> <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000066; font-weight: bold;">return</span> <span style="color: #003366; font-weight: bold;">false</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<h2><span id="Accessing_Files_with_PHP">Accessing Files with PHP</span></h2>
<p>When a DynaForm is submitted, the case variable created for a file object just contains the filename (not including the path) of the uploaded file. The file is assigned a case-document UID and is stored in the file system under its case UID and its case-document UID and version number at the path:</p>
<p><tt><a href="../File_Locations.html#Installation_Directory" title="File Locations"><install-directory></install-directory></a></tt><a href="../File_Locations.html#Installation_Directory" title="File Locations">&lt;INSTALL-DIRECTORY&gt;</a><span>/shared/sites/&lt;WORKSPACE&gt;/files/&lt;CASE-UID&gt;/&lt;CASE-DOCUMENT-UID&gt;_&lt;VERSION-NUMBER&gt;.&lt;EXT&gt;</span><tt><workspace><case-uid><case-document-uid><version-number><ext></ext></version-number></case-document-uid></case-uid></workspace></tt></p>
<p>The extension of the saved file stays the same as the original file, but the filename is replaced by the unique ID for the case-document. The version number starts counting from the number 1. If a new version of an Input Document file is uploaded, then the version number will increment by 1:</p>
<p><tt><a href="../File_Locations.html#Installation_Directory" title="File Locations"><install-directory></install-directory></a></tt><a href="../File_Locations.html#Installation_Directory" title="File Locations">&lt;INSTALL-DIRECTORY&gt;</a>/shared/sites/&lt;WORKSPACE&gt;/files/&lt;CASE-UID&gt;/&lt;CASE-DOCUMENT-UID&gt;_&lt;VERSION-NUMBER&gt;.&lt;EXT&gt;<tt><install-directory><workspace><case-uid><case-document-uid><version-number><ext></ext></version-number></case-document-uid></case-uid></workspace></install-directory></tt></p>
<p>For example, the file "invoice.pdf" uploaded to case "7981335114dd4055c4db591044609268" (in the default "workflow" workspace on a Linux server) gets assigned a case-document UID of "3431059204de557e849e904027595620". Then, it would be stored at:</p>
<p><tt>/opt/processmaker/shared/sites/workflow/files/7981335114dd4055c4db591044609268/3431059204de557e849e904027595620_1.pdf</tt></p>
<p>In version 2.5.1 and later, an option was added to allow <a href="../Managing_32K_Folders.html">case files to be stored in a series of 3 subdirectories</a> created from the case's unique ID to avoid the 32K file limits of Linux's ext3 file system. In version 3.0 and later, this option is activated by default. This means that a directory using the case's unique ID, such as <tt>/7981335114dd4055c4db591044609268/</tt> in the above example, becomes 3 subdirectories whose names are three characters in the case's unique ID, with the rest of the unique ID placed in the name of another subdirectory:</p>
<p><tt>/opt/processmaker/shared/sites/workflow/files<b>/798/133/511/4dd4055c4db591044609268/</b>3431059204de557e849e904027595620_1.pdf</tt></p>
<p>If accessing an attached file in a ProcessMaker trigger or plugin, the it is recommended to use the defined constants PATH_DOCUMENT, which holds the location of the case files, such as <code>"/opt/processmaker/shared/sites/workflow/files/"</code> on a Linux/UNIX system, and <code>PATH_SEP</code>, which is <code>"/"</code> on Linux/UNIX systems and <code>"\"</code> on Windows systems to separate directories in the file system. The <a href="../Internal_Functions_and_Classes.html#G::getPathFromUID.28.29">G::getPathFromUID()</a> method may be used in version 2.5.1 or later to break a unique ID number into subdirectories in this way if the system requires it. For example to get an attached file with the case-file ID of 6960198894e6927e0a40b14004833875 and the version number 1 in the current case:
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$g</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> G<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$OutDocPath</span> <span style="color: #339933;">=</span> PATH_DOCUMENT <span style="color: #339933;">.</span> <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getPathFromUID</span><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;6960198894e6927e0a40b14004833875_1.pdf&quot;</span><span style="color: #339933;">;</span></div></div>
If unsure if in version 2.5.1 or later, then use <a href="http://php.net/manual/en/function.method-exists.php">method_exists()</a> to check whether <code>G::getPathFromUID()</code> exists before calling it.
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$caseId</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'a03459e1cb9824dac456780eca7b5cf6'</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$g</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> G<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$caseIdPath</span> <span style="color: #339933;">=</span> <a href="http://php.net/method_exists"><span style="color: #990000;">method_exists</span></a><span style="color: #009900;">&#40;</span>G<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;getPathFromUID&quot;</span><span style="color: #009900;">&#41;</span> ? <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getPathFromUID</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$caseId</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">:</span> <span style="color: #000088;">$caseId</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$OutDocPath</span> <span style="color: #339933;">=</span> PATH_DOCUMENT <span style="color: #339933;">.</span> <span style="color: #000088;">$caseIdPath</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;6960198894e6927e0a40b14004833875_2.pdf&quot;</span><span style="color: #339933;">;</span></div></div>

<p>Information about uploaded files (including input documents) is stored in the <strong><tt>wf_<workspace>.APP_DOCUMENT</workspace></tt></strong> table. The <strong><tt>APP_DOC_UID</tt></strong> field is case-document UID assigned to the uploaded file and the <strong><tt>APP_UID</tt></strong> field is the case UID. If the uploaded file is an Input Document, then the <strong><tt>DOC_UID</tt></strong> field will contain the UID for the Input Document and the <strong><tt>APP_DOC_TYPE</tt></strong> field will be set to 'INPUT'. If uploaded file is not an Input Document, then <strong><tt>DOC_UID</tt></strong> will be set to '-1' and <strong><tt>APP_DOC_TYPE</tt></strong> will be set to 'ATTACHED'. The original filename of the uploaded file is stored in the <strong><tt>wf_<workspace>.CONTENT</workspace></tt></strong> table, where <strong><tt>CON_ID</tt></strong> is set to the case-document UID, <strong><tt>CON_CATEGORY</tt></strong> is set to <tt>'APP_DOC_FILENAME'</tt>, and <strong><tt>CON_VALUE</tt></strong> is the original filename.</p>
<p>Uploaded files can be opened with a trigger by looking up the file location in the database and then using standard PHP functions to open the file saved to the file system.</p>
<p style="margin-left:25px"><strong><font color="green">Note:</font></strong><font color="dimgray"> Uploaded files are not saved to the file system and records are not created in the database until after any triggers associated with the DynaForm are fired. In order to manipulate uploaded files with a trigger, the trigger should be set to fire before the next step in the task. If the DynaForm is the last step in the task, then set the trigger to fire before assignment of the next user.</font></p>
<h3><span id="Inserting_Uploaded_Files_in_an_Email">Inserting Uploaded Files in an Email</span></h3>
<p>For example, a DynaForm has a file field named "UploadInvoice", which is an HTML file which needs to be sent out in an email to the Accounting department. In the <a href="../Process_Files_Manager.html" title="Process Files Manager">Process Files Manager</a>, a template file has been created in the <strong><tt>mailTemplates</tt></strong> directory which is named <strong><tt>InvoiceTemplate.html</tt></strong>. This email template file contains the following:</p>

<codeblock>Invoice from case: @#APPLICATION
Date: @#Date
Time: @#Time
@#Contents
</codeblock>

<p>After the DynaForm is submitted, the following trigger is fired <i>before</i> the next step which queries the <strong><tt>CONTENT</tt></strong> and <strong><tt>APP_DOCUMENT</tt></strong> tables to find where the file has been stored in the file system. The trigger then opens the file and extracts the contents. If the file is an HTML document, it only extracts the text between the <span>&lt;body&gt;</span>tags. Then, it uses the <a href="../Notifications.html#Sending_emails_with_PMFSendMessage.28.29" title="Notifications">PMFSendMessage()</a>function to send out a message with the contents of the uploaded file inserted into the <strong><tt>InvoiceTemplate.html</tt></strong> file.</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><a href="http://php.net/trim"><span style="color: #990000;">trim</span></a><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>UploadInvoice<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//assign to normal PHP variables, so can be inserted in strings:</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$invoiceFile</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>UploadInvoice<span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$caseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//query to find the assigned UID for the uploaded file:</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$query</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT APP_DOC_UID FROM CONTENT C, APP_DOCUMENT AD &quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">&quot;WHERE C.CON_VALUE = '<span style="color: #006699; font-weight: bold;">$invoiceFile</span>' AND &quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">&quot;AD.APP_DOC_UID = C.CON_ID AND AD.APP_UID = '<span style="color: #006699; font-weight: bold;">$caseId</span>'&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$query</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp;<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$g</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> G<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$caseIdPath</span> <span style="color: #339933;">=</span> <a href="http://php.net/method_exists"><span style="color: #990000;">method_exists</span></a><span style="color: #009900;">&#40;</span>G<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;getPathFromUID&quot;</span><span style="color: #009900;">&#41;</span> ? <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getPathFromUID</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$caseId</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">:</span> <span style="color: #000088;">$caseId</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$filePath</span> <span style="color: #339933;">=</span> PATH_DOCUMENT <span style="color: #339933;">.</span> <span style="color: #000088;">$caseIdPath</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000088;">$result</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_DOC_UID'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">'_1.'</span> <span style="color: #339933;">.</span> <a href="http://php.net/pathinfo"><span style="color: #990000;">pathinfo</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$invoiceFile</span><span style="color: #339933;">,</span> PATHINFO_EXTENSION<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$invoiceContents</span> <span style="color: #339933;">=</span> <a href="http://php.net/file_get_contents"><span style="color: #990000;">file_get_contents</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$filePath</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$invoiceContents</span> <span style="color: #339933;">!=</span> <span style="color: #009900; font-weight: bold;">FALSE</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//pull out the text between the &lt;body&gt;...&lt;/body&gt; tags of the HTML document</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/preg_match"><span style="color: #990000;">preg_match</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'/&lt;body&gt;(.*)&lt;\/body&gt;/i'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$invoiceContents</span><span style="color: #339933;">,</span> <span style="color: #000088;">$matches</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000088;">$invoiceContents</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$matches</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//Only include the (.*) part</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'boss@acme.com'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'accounting@acme.com'</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'Invoice to review'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'InvoiceTemplate.html'</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'Date'</span><span style="color: #339933;">=&gt;</span> getCurrentDate<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'Time'</span> <span style="color: #339933;">=&gt;</span> getCurrentTime<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'Contents'</span><span style="color: #339933;">=&gt;</span><span style="color: #000088;">$invoiceContents</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<h3><span id="Inserting_Uploaded_Files_in_a_Database">Inserting Uploaded Files in a Database</span></h3>
<p>The same code above can be used to insert the uploaded file into a field in a database. Just replace the <strong><tt>if</tt></strong> section in the code above with the following code, which should work for both text files and binary files:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$invoiceContents</span> <span style="color: #339933;">!=</span> <span style="color: #009900; font-weight: bold;">FALSE</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//the UID for the database connection:</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$db</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'XXXXXXXXXXXXXXXXXXXXXXXX'</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$invoiceContents</span> <span style="color: #339933;">=</span> <a href="http://php.net/addslashes"><span style="color: #990000;">addslashes</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$invoiceContents</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//insert $invoiceContents in the database:</span><br />
&nbsp; &nbsp;executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;INSERT INTO ACCOUNTS (ID, INVOICE) VALUES ('<span style="color: #006699; font-weight: bold;">$caseId</span>', '<span style="color: #006699; font-weight: bold;">$invoiceContents</span>')&quot;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$db</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<p>For example, to insert the file into a ProcessMaker <a href="Report_Tables.html" title="Report Tables">Report Table</a> named "casedata", go into the <strong><tt>rp_<workspace></workspace></tt></strong> database and add a BLOB field named "<tt>invoice</tt>" to the <strong><tt>CASE_DATA</tt></strong> table. Then, use the following code to insert the uploaded invoice file into the <strong><tt>rp_<workspace>.CASE_DATA.invoice</workspace></tt></strong> field:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$invoiceContents</span> <span style="color: #339933;">!=</span> <span style="color: #009900; font-weight: bold;">FALSE</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$db</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'report'</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$caseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$invoiceContents</span> <span style="color: #339933;">=</span> <a href="http://php.net/addslashes"><span style="color: #990000;">addslashes</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$invoiceContents</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//insert $invoiceContents in the database:</span><br />
&nbsp; &nbsp;executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;UPDATE CASE_DATA SET invoice='<span style="color: #006699; font-weight: bold;">$invoiceContents</span>' WHERE APP_UID = '<span style="color: #006699; font-weight: bold;">$caseId</span>'&quot;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$db</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<h3><span id="Importing_an_Uploaded_CSV_File_into_a_Grid">Importing an Uploaded CSV File into a Grid</span></h3>
<p>To import database or spreadsheet data into a DynaForm grid, export the data as a <i>comma separated value</i> (CSV) file. Then, upload the data to a file field and fire a trigger <i>before</i> the next step to parse the file and insert it into an associative array of associative arrays, which can be assigned to a grid in a subsequent DynaForm.</p>
<p>In this example, there is a file field named "<tt>csvFile</tt>" where the user uploads a CSV file, whose data will be imported into a subsequent grid named "<tt>expensesGrid</tt>". It contains four fields named "expDate", "expAccount", "expAmount", "expDescription", which will be populated. If unable to open the uploaded CSV file or can't read its data, then an error message is displayed, and the case is redirected to the previous DynaForm with the unique ID "67172619648d67d3d5db8f8066114860" to upload a new CSV file.</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span><a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>csvFile<span style="color: #009900;">&#41;</span> or <a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>csvFile<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$mesg</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;CSV File is empty. Please upload again.&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; goto uploadAgain<span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #000088;">$csvFile</span> <span style="color: #339933;">=</span> <a href="http://php.net/trim"><span style="color: #990000;">trim</span></a><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>csvFile<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">#assign to PHP variables to insert in query<br />
</span><span style="color: #000088;">$caseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span><br />
<br />
<span style="color: #666666; font-style: italic;">//find the assigned UID for the uploaded file:</span><br />
<span style="color: #000088;">$query</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT C.CON_ID FROM CONTENT C, APP_DOCUMENT AD WHERE<br />
&nbsp; &nbsp;AD.APP_UID = '<span style="color: #006699; font-weight: bold;">$caseId</span>' AND AD.APP_DOC_UID = C.CON_ID AND C.CON_VALUE = '<span style="color: #006699; font-weight: bold;">$csvFile</span>'&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$query</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">||</span> <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">==</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$mesg</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;Error: Unable to find the uploaded file '<span style="color: #006699; font-weight: bold;">$csvFile</span>' in the APP_DOCUMENT table.&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;goto uploadAgain<span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #000088;">$g</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> G<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$caseIdPath</span> <span style="color: #339933;">=</span> <a href="http://php.net/method_exists"><span style="color: #990000;">method_exists</span></a><span style="color: #009900;">&#40;</span>G<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;getPathFromUID&quot;</span><span style="color: #009900;">&#41;</span> ? <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getPathFromUID</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$caseId</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">:</span> <span style="color: #000088;">$caseId</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$filePath</span> <span style="color: #339933;">=</span> PATH_DOCUMENT <span style="color: #339933;">.</span> <span style="color: #000088;">$caseIdPath</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #000088;">$result</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'CON_ID'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">'_1.'</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp;<a href="http://php.net/pathinfo"><span style="color: #990000;">pathinfo</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$csvFile</span><span style="color: #339933;">,</span> PATHINFO_EXTENSION<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$aRecords</span> <span style="color: #339933;">=</span> <a href="http://php.net/file"><span style="color: #990000;">file</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$filePath</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//Open the CSV file as an array for each line</span><br />
<br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$aRecords</span> <span style="color: #339933;">===</span> <span style="color: #009900; font-weight: bold;">false</span> or <span style="color: #339933;">!</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aRecords</span><span style="color: #009900;">&#41;</span> or <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aRecords</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&lt;</span> <span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$mesg</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;Error: CSV File '<span style="color: #006699; font-weight: bold;">$csvFile</span>' is not valid format or does not contain any records.&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;goto uploadAgain<span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #339933;">@=</span>expensesGrid <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #666666; font-style: italic;">//Assume that the first line of the CSV file is data and not column headers.</span><br />
<span style="color: #666666; font-style: italic;">//Loop through the array and for each record break the line into its individual fields.</span><br />
<span style="color: #b1b100;">for</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$i</span> <span style="color: #339933;">=</span> <span style="color: #cc66cc;">0</span><span style="color: #339933;">;</span> <span style="color: #000088;">$i</span> <span style="color: #339933;">&lt;</span> <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aRecords</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #000088;">$i</span><span style="color: #339933;">++</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//change to ',' if using commas instead of semicolons in the CSV File</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aFields</span> <span style="color: #339933;">=</span> <a href="http://php.net/explode"><span style="color: #990000;">explode</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">';'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aRecords</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//change the fields names to match your grid:</span><br />
&nbsp; &nbsp;<span style="color: #339933;">@=</span>expensesGrid<span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span> <span style="color: #339933;">+</span> <span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'expDate'</span> &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <a href="http://php.net/trim"><span style="color: #990000;">trim</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aFields</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;<span style="color: #000099; font-weight: bold;">\t</span><span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\&quot;</span> &quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'expAccount'</span> &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <a href="http://php.net/trim"><span style="color: #990000;">trim</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aFields</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;<span style="color: #000099; font-weight: bold;">\t</span><span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\&quot;</span> &quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'expAmount'</span> &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <a href="http://php.net/trim"><span style="color: #990000;">trim</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aFields</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;<span style="color: #000099; font-weight: bold;">\t</span><span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\&quot;</span> &quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'expDescription'</span> <span style="color: #339933;">=&gt;</span> <a href="http://php.net/trim"><span style="color: #990000;">trim</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aFields</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;<span style="color: #000099; font-weight: bold;">\t</span><span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\&quot;</span> &quot;</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
goto endScript<span style="color: #339933;">;</span><br />
<br />
uploadAgain<span style="color: #339933;">:</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$g</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> G<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">SendMessageText</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$mesg</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'ERROR'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//change for the unique ID of your DynaForm:</span><br />
&nbsp; &nbsp;PMFRedirectToStep<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #339933;">@%</span>INDEX<span style="color: #339933;">,</span> <span style="color: #0000ff;">'DYNAFORM'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'67172619648d67d3d5db8f8066114860'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
endScript<span style="color: #339933;">:</span></div></div>
</div></div></div>  </div>

      <footer>
          </footer>
  
    </div>
  
</div> <!-- /.block -->
</div>
 <!-- /.region -->
      </section>
    </div>
  
      
    </div>

      
</div>

 <!---add diego--->
  <div id="download-app-section" class="download-app mobile-none">
			<div class="row">
				<div class="col-md-12">
					<div class="text_app">Download our app</div>
							<a href="https://itunes.apple.com/us/app/processmaker/id992576284?ls=1&mt=8" target="_blank">
								<img src="https://wiki.processmaker.com/themes/thecompany_responsive_theme/images/appstore.png">
							<a href="https://play.google.com/store/apps/details?id=com.colosa.processmaker" target="_blank">
								<img src="https://wiki.processmaker.com/themes/thecompany_responsive_theme/images/playstore.png">				
				</div>
			</div>
  </div>
  <!---end diego--->
<!----add diego----->    
		<div class="logo_processmaker"><a href="http://www.processmaker.com">
		<img src="https://wiki.processmaker.com/themes/thecompany_responsive_theme/images/logo_processmaker.png"></div>
<!----end diego----->
<div id="footer">
  <div id="footer_wrapper">
      </div>

  <div class="social-media-wrapper">
         <div id="social-media-icons">
       <ul>
       	<div class="text_contact">Contact us</div>
				<div class="text_number">+1-617-340-3377</div>
        <!--<li><a class="rss" href="/rss.xml">rss</a></li> <!--edit diego-->
        <li><a class="facebook" href="http://facebook.com/processmaker/" target="_blank" rel="me">facebook</a></li>
        <li><a class="twitter" href="https://twitter.com/processmaker" target="_blank" rel="me">twitter</a></li>
        <li><a class="gplus" href="https://www.google.com/+ProcessMakerOpenSource" target="_blank" rel="me">Gplus</a></li>
        <li><a class="linkedin" href="https://www.linkedin.com/groups?mostRecent=&gid=3970335&trk=my_groups-tile-flipgrp" target="_blank" rel="me">Linked in</a></li>
        <!--<li><a class="dribbble" href="http://dribbble.com" target="_blank" rel="me">Dribbble</a></li>
        <li><a class="vimeo" href="http://vimeo.com" target="_blank" rel="me">Vimeo</a></li>-->
        <li><a class="youtube" href="https://www.youtube.com/user/processmaker" target="_blank" rel="me">Youtube</a></li>
       </ul>
      </div>
      </div>
  
  <div class="footer_credit">
    <div class="footer_inner_credit">
           <div id="foot"><div class="region region-footer">
  <div id="block-block-2" class="block block-block">

      
  <div class="content">
    <p><font style="font-family:arial,sans-serif; font-size:15px; font-weight: none; color:#FFF">Automate your Workflow with Business Process Management<br>Software licensed under the <a 1px="" class="external text" href="http://www.gnu.org/licenses/agpl.html" rel="nofollow" style="padding-right: 13px; color:white;">GNU Affero General Public License version 3</a><br>Contact us:&nbsp;<a class="external free" href="mailto:community@processmaker.com" rel="nofollow" style="font-weight:bold;color:white;text-decoration:underline;">community@processmaker.com</a><br><a class="external free" href="https://www.processmaker.com/privacy-statement" rel="nofollow" style="font-weight:bold;color:white;text-decoration:underline;">Privacy Statement</a></font><br><font style="font-family:arial,sans-serif; font-size:15px; font-weight: none; color:#FFF"> Copyright 2000-2024 ProcessMaker Inc. All rights reserved.</font></p>
  </div>
  
</div> <!-- /.block -->
</div>
 <!-- /.region -->
</div>
         
   <!-- <div id="copyright">
      <p class="copyright">Copyright &copy; 2024, Documentation@ProcessMaker </p>
      <!--<p class="credits"> Developed by  <a href="http://www.zymphonies.com">Zymphonies</a></p>
      <div class="clear"></div>
    </div>-->
  </div>
  
  </div>
</div>

</div>

<script type="text/javascript">
  /* <![CDATA[ */
  document.write (
    '<img src="https://marketing.processmaker.com/acton/bn/3812/visitor.gif?ts='+ new Date().getTime()+ '&ref='+escape(document.referrer) + '">'
  );
  /* ]]> */
</script>
  
</div>
    <style>
    .center-div{
        width: 100%;        
        margin: 0 auto;
        z-index:10000;
        position:fixed;
        bottom: 0px;
        cursor:pointer;
    }
    .round-popup{
        margin:0 auto;
        font-family: 'Montserrat', sans-serif;
        font-size: 15px;
        font-weight: lighter;
        width: 412px;
        height: 50px;
        padding-top: 7px;
        text-align: center;
        position:relative;
    }
    .round-popup-button{
        position:absolute;
        top: 11px;
        right: 15px;
        background: transparent;
        border:none;
        font-size:15px;
        font-weight:normal;
        line-height:20px;
        width:20px;
        height:20px;
        padding:0;
    }
    .round-background-blue{
        background: url('http://www.processmaker.com/uploads/blue.png')no-repeat;
        color:white;
        
    }
    #box-pm31-button-blue{
        color: rgba(255, 255, 255, 0.5);
    }
    
    #box-pm31-button-blue:active,#box-pm31-button-blue:focus{
        border:none;
        outline:none;
    }
    .round-background-blue a{
        color: white!important;
        text-decoration: none;
        font-size: 15px;
        line-height:45px;
        font-family:Montserrat, sans-serif;
    }
    .round-background-blue span{
        font-weight: bold;
    }
    /*WHITE background*/
    .round-background-white{
        background: url('http://www.processmaker.com/uploads/white.png')no-repeat;
        background-position-x: -9px;        
        color: #3397E1;
    }
    .round-background-white a:hover{
        color: #3397E1!important;
        text-decoration: none;
        font-size: 15px;
    }
    #box-pm31-button-white{
        color: rgba(51, 151, 225, 0.7);
    }
</style>
    <div id="box-pm31" class="center-div" style="display:none;">
        <div class="round-popup round-background-blue">
            <a onclick="ga('send', 'event', 'WikiBlueBanner','click','PM31Release');" href="http://www.processmaker.com/download-processmaker-landing-page">
                <span>ProcessMaker 3.1</span> is Here! Download Now <span style="font-size:20px;font-weigth:normal;"></span>
            </a>
            <button id="box-pm31-button-blue" class="round-popup-button">&times;</button>
        </div>
    </div>
    <script>

function pmCreateCookie(name,value,days) {
    if (days) {
        var date = new Date();
        date.setTime(date.getTime()+(days*24*60*60*1000));
        var expires = "; expires="+date.toGMTString();
    }
    else var expires = "";
    document.cookie = name+"="+value+expires+"; path=/";
}

function pmReadCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
}

function pmEraseCookie(name) {
    createCookie(name,"",-1);
}



     jQuery(document).ready(function( $ ) {
        $('#box-pm31-button-blue').click(function(e){
                e.stopPropagation();
                $('#box-pm31').slideUp('fast');
                pmCreateCookie('ppcookie','val',10);
            });
        });
        jQuery(window).load(function() {
            if(pmReadCookie('ppcookie') !== 'val'){
                //jQuery('#box-pm31').delay( 2000 ).slideDown('slow');
            }
        });
    </script>
<link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet">

<script type="text/javascript">
  (function() {
    window._pa = window._pa || {};
    // _pa.orderId = "myOrderId"; // OPTIONAL: attach unique conversion identifier to conversions
    // _pa.revenue = "19.99"; // OPTIONAL: attach dynamic purchase values to conversions
    // _pa.productId = "myProductId"; // OPTIONAL: Include product ID for use with dynamic ads
    var pa = document.createElement('script'); pa.type = 'text/javascript'; pa.async = true;
    pa.src = ('https:' == document.location.protocol ? 'https:' : 'http:') + "//tag.marinsm.com/serve/586a7ec3a2ae6b728400003d.js";
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(pa, s);
  })();
</script>

</body>
</html>
